import{_ as T}from"./StratoTable-BQdButlV.js";import{e as $,b as A,c as F,d as q,a as z,f as M}from"./DeleteUserGroupsForm-DNjy3A__.js";import{S as B}from"./StratoButton-AnmxT3yq.js";import{_ as G}from"./StratoDrawer-BEn6vZyQ.js";import{c as E}from"./job-BPKVJ0Lh.js";import{u as w}from"./activeJob-DfWXj1ie.js";import{l as x}from"./request-BGZJNm7h.js";import{r as a,o as p,b as C,e as t,w as i,i as j,q as g,v as k,F as I,n as J,a6 as O,d as h,u as U,f as N,P as R}from"./index-C6PxR8iA.js";import{_ as L}from"./User-gzz1togQ.js";import"./TenantTreeSelector-C6fV0oEE.js";import"./TagValueSelectorGroup-Tq596lRF.js";import"./tag-By1EEBOS.js";import"./StratoPagingSelector-CZtU1yuw.js";import"./UserSelector-I3vgcqge.js";import"./user-DS2hYLSE.js";import"./UpdateUserForm-AkLK75Wl.js";import"./role-DCPu0vWf.js";const H={__name:"CreateUserGroupButton",emits:["confirm"],setup(b,{emit:v}){const c=w(),l=a(!1),o=a(!1);function u(){n.value=x.cloneDeep(d),l.value=!0}const d={tenantId:void 0,name:void 0,alias:void 0,description:void 0,tags:[]},n=a(x.cloneDeep(d)),m=a(),_=v;function s(){m.value.validate(r=>{r&&(o.value=!0,E({jobType:"CREATE_USER_GROUP",jobParameters:n.value}).then(e=>{l.value=!1,c.setActiveJobId(e.jobId),_("confirm")}).finally(()=>{o.value=!1}))})}return(r,e)=>(p(),C(I,null,[t(B,{type:"primary",onClick:u},{default:i(()=>[j("创建")]),_:1}),t(G,{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=f=>l.value=f),title:"创建用户组",onOnConfirm:s,loading:o.value,size:"600"},{default:i(()=>[l.value?(p(),g($,{key:0,ref_key:"formRef",ref:m,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=f=>n.value=f)},null,8,["modelValue"])):k("",!0)]),_:1},8,["modelValue","loading"])],64))}},K={__name:"UpdateUserGroupButton",props:{selectedGroups:{type:Array,required:!0}},emits:["confirm"],setup(b,{emit:v}){const c=w(),l=b,o=a(!1),u=a(!1);function d(){l.selectedGroups.length!==0&&(n.value.userGroupId=l.selectedGroups[0].id,o.value=!0)}const n=a({}),m=a(),_=v;function s(){m.value.validate(r=>{r&&(u.value=!0,E({jobType:"UPDATE_USER_GROUP",jobParameters:n.value}).then(e=>{o.value=!1,c.setActiveJobId(e.jobId),_("confirm")}).finally(()=>{u.value=!1}))})}return(r,e)=>{const f=J("ElButton");return p(),C(I,null,[t(f,{type:"primary",link:"",onClick:d},{default:i(()=>[j("更新")]),_:1}),(p(),g(O,{to:"body"},[t(G,{modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=D=>o.value=D),title:"更新用户组",onOnConfirm:s,loading:u.value,size:"600"},{default:i(()=>[o.value?(p(),g(A,{key:0,ref_key:"formRef",ref:m,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=D=>n.value=D)},null,8,["modelValue"])):k("",!0)]),_:1},8,["modelValue","loading"])]))],64)}}},Q={__name:"JoinUserGroupButton",emits:["confirm"],setup(b,{emit:v}){const c=w(),l=a(!1),o=a(!1);function u(){l.value=!0}const d=a({}),n=a(),m=v;function _(){n.value.validate(s=>{s&&(o.value=!0,E({jobType:"JOIN_USER_GROUP",jobParameters:d.value}).then(r=>{l.value=!1,c.setActiveJobId(r.jobId),m("confirm")}).finally(()=>{o.value=!1}))})}return(s,r)=>{const e=J("ElButton");return p(),C(I,null,[t(e,{onClick:u,type:"primary",link:""},{default:i(()=>[j("找不到期望的用户组? 点击此处申请加入")]),_:1}),t(G,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=f=>l.value=f),title:"申请加入用户组",onOnConfirm:_,loading:o.value},{default:i(()=>[t(F,{ref_key:"formRef",ref:n,modelValue:d.value,"onUpdate:modelValue":r[0]||(r[0]=f=>d.value=f)},null,8,["modelValue"])]),_:1},8,["modelValue","loading"])],64)}}},W=h("span",{style:{"font-size":"12px"}},"邀请新成员",-1),X=h("span",{style:{"font-size":"12px"}},"移除成员",-1),Y={__name:"MembersButton",props:{selectedGroups:{type:Array,required:!0}},setup(b){const v=w(),c=b,l=a(!1),o=a(),u=a();function d(){c.selectedGroups.length!==0&&(o.value=c.selectedGroups[0],l.value=!0)}const n=a([]);function m(y){n.value=y}function _(){E({jobType:"REMOVE_USERS_FROM_GROUP",jobParameters:{userGroupId:o.value.id,userIds:n.value.map(y=>y.id)}}).then(y=>{v.setActiveJobId(y.jobId),u.value.fetchData()})}const s=a({userGroupId:void 0,userIds:[]}),r=a(),e=a(!1);function f(){s.value.userGroupId=o.value.id,e.value=!0}function D(){r.value.validate(y=>{y&&E({jobType:"INVITE_USERS_TO_GROUP",jobParameters:s.value}).then(V=>{e.value=!1,v.setActiveJobId(V.jobId),u.value.fetchData()})})}return(y,V)=>{const P=J("ElButton");return p(),C(I,null,[t(P,{type:"primary",onClick:d,link:""},{default:i(()=>[j("成员管理")]),_:1}),(p(),g(O,{to:"body"},[t(G,{size:800,modelValue:l.value,"onUpdate:modelValue":V[0]||(V[0]=S=>l.value=S),title:"成员管理","no-confirm":""},{default:i(()=>[l.value?(p(),g(L,{key:0,"simple-mode":"","user-group-ids":[o.value.id],onChange:m,ref_key:"tableRef",ref:u},{buttons:i(()=>[t(B,{size:"small",type:"success",plain:"",onClick:f},{default:i(()=>[W]),_:1}),t(B,{size:"small",type:"danger",plain:"",disabled:n.value.length===0,onClick:_},{default:i(()=>[X]),_:1},8,["disabled"])]),_:1},8,["user-group-ids"])):k("",!0)]),_:1},8,["modelValue"]),t(G,{modelValue:e.value,"onUpdate:modelValue":V[2]||(V[2]=S=>e.value=S),title:"邀请新成员",onOnConfirm:D},{default:i(()=>[t(q,{ref_key:"inviteFormRef",ref:r,modelValue:s.value,"onUpdate:modelValue":V[1]||(V[1]=S=>s.value=S)},null,8,["modelValue"])]),_:1},8,["modelValue"])]))],64)}}},Z={__name:"DeleteUserGroupsButton",props:{selectedGroups:{type:Array,required:!0}},emits:["confirm"],setup(b,{emit:v}){const c=w(),l=b,o=a(!1),u=a(!1);function d(){l.selectedGroups.length!==0&&(n.value.userGroupIds=l.selectedGroups.map(r=>r.id),o.value=!0)}const n=a({}),m=a(),_=v;function s(){m.value.validate(r=>{r&&(u.value=!0,E({jobType:"DELETE_USER_GROUPS",jobParameters:n.value}).then(e=>{o.value=!1,c.setActiveJobId(e.jobId),_("confirm")}).finally(()=>{u.value=!1}))})}return(r,e)=>(p(),C(I,null,[t(B,{disabled:b.selectedGroups.length===0,plain:"",type:"danger",onClick:d},{default:i(()=>[j("删除")]),_:1},8,["disabled"]),(p(),g(O,{to:"body"},[t(G,{modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=f=>o.value=f),title:"删除用户组",onOnConfirm:s,loading:u.value,size:"600"},{default:i(()=>[o.value?(p(),g(z,{key:0,ref_key:"formRef",ref:m,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=f=>n.value=f)},null,8,["modelValue"])):k("",!0)]),_:1},8,["modelValue","loading"])]))],64))}},ee={style:{"margin-bottom":"10px"}},ge={__name:"UserGroup",props:{simpleMode:{default:!1,required:!1}},setup(b){const v=b,c=a({}),l=a([]);function o(n){l.value=n}const u=a();function d(){u.value.fetchData()}return(n,m)=>{const _=J("ElSpace");return p(),C(I,null,[h("div",ee,[v.simpleMode?k("",!0):(p(),g(_,{key:0,alignment:"normal"},{default:i(()=>[t(H,{onConfirm:d}),t(Z,{"selected-groups":l.value,onConfirm:d},null,8,["selected-groups"]),t(Q)]),_:1})),t(U(N),{style:{float:"right",width:"20%"},modelValue:c.value.search,"onUpdate:modelValue":m[0]||(m[0]=s=>c.value.search=s),"suffix-icon":"search"},null,8,["modelValue"])]),t(T,{ref_key:"tableRef",ref:u,"paging-request":c.value,"remote-method":U(M),onSelectionChange:o},{default:i(()=>[v.simpleMode?k("",!0):(p(),g(U(R),{key:0,type:"selection","reserve-selection":""})),t(U(R),{prop:"name",label:"名称",sortable:"custom"}),t(U(R),{prop:"alias",label:"别名",sortable:"custom"}),t(U(R),{prop:"description",label:"描述"}),t(U(R),{prop:"createdAt",label:"创建时间",sortable:"custom"}),t(U(R),null,{default:i(s=>[t(K,{"selected-groups":[s.row],onConfirm:d},null,8,["selected-groups"]),t(Y,{"selected-groups":[s.row]},null,8,["selected-groups"])]),_:1})]),_:1},8,["paging-request","remote-method"])],64)}}};export{ge as default};
