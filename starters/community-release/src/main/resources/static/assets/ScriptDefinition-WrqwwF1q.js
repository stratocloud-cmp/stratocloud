import{_ as q}from"./StratoDrawer-i3nJdUbZ.js";import{S}from"./StratoButton-BRlR7RNE.js";import{_ as B}from"./RemoteScriptDef-B0TuVjI8.js";import{_ as z}from"./TenantTreeSelector-cjxWtDlB.js";import{_ as P}from"./UserSelector-CoJSGQ4A.js";import{v as $}from"./FormUtil-CHSbmSKI.js";import{a7 as h,r as m,n as d,o as w,b as R,e,w as l,F as k,d as F,u as U,i as g,O as A,f as G,t as C,q as x,v as T}from"./index-CJwSUwqU.js";import{c as H,u as J,a as L,e as Q,b as W,d as X}from"./scriptDefinition-YE6MXqAV.js";import{_ as Y}from"./StratoTable-EZs1qWj6.js";import"./StratoCodeBlock-TLULY6tz.js";import"./request-IeLrxslB.js";import"./StratoPagingSelector-DNkLqj4O.js";import"./user-Ce1W_vfQ.js";const Z={__name:"CreateScriptDefinitionForm",props:{modelValue:{required:!0,type:Object},modelModifiers:{}},emits:["update:modelValue"],setup(y,{expose:D}){const t=h(y,"modelValue"),p=m(),v=m();function I(_){$([p.value,v.value],_)}return D({validate:I}),(_,o)=>{const r=d("ElFormItem"),s=d("ElCol"),f=d("ElInput"),c=d("ElSwitch"),b=d("ElRow"),E=d("ElForm");return w(),R(k,null,[e(E,{ref_key:"formRef",ref:p,model:t.value,"label-position":"top"},{default:l(()=>[e(b,{gutter:24},{default:l(()=>[e(s,{span:12},{default:l(()=>[e(r,{label:"租户",prop:"tenantId",required:"","show-message":!1},{default:l(()=>[e(z,{modelValue:t.value.tenantId,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.tenantId=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(r,{label:"所有者",prop:"ownerId",required:"","show-message":!1},{default:l(()=>[e(P,{modelValue:t.value.ownerId,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.ownerId=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(r,{label:"脚本标识",prop:"definitionKey",required:"","show-message":!1},{default:l(()=>[e(f,{modelValue:t.value.definitionKey,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.definitionKey=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(r,{label:"脚本名称",prop:"name",required:"","show-message":!1},{default:l(()=>[e(f,{modelValue:t.value.name,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.name=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:l(()=>[e(r,{label:"公用脚本",prop:"publicDefinition"},{default:l(()=>[e(c,{modelValue:t.value.publicDefinition,"onUpdate:modelValue":o[4]||(o[4]=a=>t.value.publicDefinition=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:6},{default:l(()=>[e(r,{label:"在依赖目标中可见",prop:"visibleInTarget"},{default:l(()=>[e(c,{modelValue:t.value.visibleInTarget,"onUpdate:modelValue":o[5]||(o[5]=a=>t.value.visibleInTarget=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:l(()=>[e(r,{label:"描述",prop:"description"},{default:l(()=>[e(f,{type:"textarea",modelValue:t.value.description,"onUpdate:modelValue":o[6]||(o[6]=a=>t.value.description=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),e(B,{ref_key:"scriptDefFormRef",ref:v,modelValue:t.value.remoteScriptDef,"onUpdate:modelValue":o[7]||(o[7]=a=>t.value.remoteScriptDef=a)},null,8,["modelValue"])],64)}}},ee={__name:"UpdateScriptDefinitionForm",props:{modelValue:{required:!0,type:Object},modelModifiers:{}},emits:["update:modelValue"],setup(y,{expose:D}){const t=h(y,"modelValue"),p=m(),v=m();function I(_){$([p.value,v.value],_)}return D({validate:I}),(_,o)=>{const r=d("ElInput"),s=d("ElFormItem"),f=d("ElCol"),c=d("ElSwitch"),b=d("ElRow"),E=d("ElForm");return w(),R(k,null,[e(E,{ref_key:"formRef",ref:p,model:t.value,"label-position":"top"},{default:l(()=>[e(b,{gutter:24},{default:l(()=>[e(f,{span:12},{default:l(()=>[e(s,{label:"脚本名称",prop:"name",required:"","show-message":!1},{default:l(()=>[e(r,{modelValue:t.value.name,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value.name=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:6},{default:l(()=>[e(s,{label:"公用脚本",prop:"publicDefinition"},{default:l(()=>[e(c,{modelValue:t.value.publicDefinition,"onUpdate:modelValue":o[1]||(o[1]=a=>t.value.publicDefinition=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:6},{default:l(()=>[e(s,{label:"在依赖目标中可见",prop:"visibleInTarget"},{default:l(()=>[e(c,{modelValue:t.value.visibleInTarget,"onUpdate:modelValue":o[2]||(o[2]=a=>t.value.visibleInTarget=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(f,{span:12},{default:l(()=>[e(s,{label:"描述",prop:"description"},{default:l(()=>[e(r,{type:"textarea",modelValue:t.value.description,"onUpdate:modelValue":o[3]||(o[3]=a=>t.value.description=a)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),e(B,{ref_key:"scriptDefFormRef",ref:v,modelValue:t.value.remoteScriptDef,"onUpdate:modelValue":o[4]||(o[4]=a=>t.value.remoteScriptDef=a)},null,8,["modelValue"])],64)}}},le={style:{"margin-bottom":"10px",height:"32px"}},ve={__name:"ScriptDefinition",setup(y){const D=m({}),t=m([]),p=m();function v(){return t.value.map(i=>i.id)}function I(i){t.value=i}const _=m(),o=m(!1),r=m();function s(){r.value={remoteScriptDef:{remoteScript:{},customForm:{items:[]}}},o.value=!0}const f=m(),c=m(!1),b=m();function E(i){b.value={scriptDefinitionId:i.id,name:i.name,description:i.description,publicDefinition:i.publicDefinition,visibleInTarget:i.visibleInTarget,remoteScriptDef:i.remoteScriptDef},c.value=!0}function a(){_.value.validate(i=>{i&&H(r.value).then(()=>{o.value=!1,p.value.fetchData()})})}function N(){f.value.validate(i=>{i&&J(b.value).then(()=>{c.value=!1,p.value.fetchData()})})}function O(){if(t.value.length===0)return;const u={scriptDefinitionIds:v()};L(u).then(()=>{p.value.fetchData()})}function K(){if(t.value.length===0)return;const u={scriptDefinitionIds:v()};Q(u).then(()=>{p.value.fetchData()})}function M(){if(t.value.length===0)return;const u={scriptDefinitionIds:v()};W(u).then(()=>{p.value.fetchData()})}return(i,u)=>{const V=d("ElTableColumn"),j=d("ElButton");return w(),R(k,null,[F("div",le,[e(S,{type:"primary",onClick:s},{default:l(()=>[g("新建")]),_:1}),e(S,{disabled:t.value.length===0,type:"success",plain:"",onClick:K},{default:l(()=>[g(" 启用 ")]),_:1},8,["disabled"]),e(S,{disabled:t.value.length===0,type:"warning",plain:"",onClick:M},{default:l(()=>[g(" 禁用 ")]),_:1},8,["disabled"]),e(U(A),{title:"确认删除",onConfirm:O},{reference:l(()=>[e(S,{disabled:t.value.length===0,type:"danger",plain:""},{default:l(()=>[g(" 删除 ")]),_:1},8,["disabled"])]),_:1}),e(U(G),{style:{float:"right",width:"20%"},modelValue:D.value.search,"onUpdate:modelValue":u[0]||(u[0]=n=>D.value.search=n),"suffix-icon":"search"},null,8,["modelValue"])]),e(Y,{ref_key:"tableRef",ref:p,"paging-request":D.value,"remote-method":U(X),onSelectionChange:I},{default:l(()=>[e(V,{type:"selection","reserve-selection":""}),e(V,{prop:"definitionKey",label:"脚本标识",sortable:"custom"}),e(V,{prop:"name",label:"脚本名称",sortable:"custom"}),e(V,{prop:"publicDefinition",label:"公用脚本",sortable:"custom"},{default:l(n=>[F("span",null,C(n.row.publicDefinition?"是":"否"),1)]),_:1}),e(V,{prop:"visibleInTarget",label:"在依赖目标中可见",sortable:"custom"},{default:l(n=>[F("span",null,C(n.row.visibleInTarget?"是":"否"),1)]),_:1}),e(V,{prop:"disabled",label:"是否禁用",sortable:"custom"},{default:l(n=>[F("span",null,C(n.row.disabled?"是":"否"),1)]),_:1}),e(V,{prop:"ownerId",label:"所有者",sortable:"custom"},{default:l(n=>[g(C(n.row.ownerRealName),1)]),_:1}),e(V,null,{default:l(n=>[e(j,{link:"",type:"primary",onClick:()=>E(n.row)},{default:l(()=>[g("编辑")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["paging-request","remote-method"]),e(q,{modelValue:o.value,"onUpdate:modelValue":u[2]||(u[2]=n=>o.value=n),title:"新建脚本定义",size:"1200",onOnConfirm:a},{default:l(()=>[o.value?(w(),x(Z,{key:0,ref_key:"createFormRef",ref:_,modelValue:r.value,"onUpdate:modelValue":u[1]||(u[1]=n=>r.value=n)},null,8,["modelValue"])):T("",!0)]),_:1},8,["modelValue"]),e(q,{modelValue:c.value,"onUpdate:modelValue":u[4]||(u[4]=n=>c.value=n),title:"编辑脚本定义",size:"1200",onOnConfirm:N},{default:l(()=>[c.value?(w(),x(ee,{key:0,ref_key:"updateFormRef",ref:f,modelValue:b.value,"onUpdate:modelValue":u[3]||(u[3]=n=>b.value=n)},null,8,["modelValue"])):T("",!0)]),_:1},8,["modelValue"])],64)}}};export{ve as default};
