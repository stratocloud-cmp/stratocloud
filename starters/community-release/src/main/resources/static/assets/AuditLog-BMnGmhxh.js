import{s as C}from"./request-BGZJNm7h.js";import{_ as N}from"./StratoTable-BQdButlV.js";import{_ as T}from"./StratoDrawer-BEn6vZyQ.js";import{S as g}from"./StratoCodeBlock-DrSVX9xC.js";import{r as f,b as I,d as p,e,u as y,w as l,F as j,o as L,f as q,i as s,t as o,n as i}from"./index-C6PxR8iA.js";import"./StratoButton-AnmxT3yq.js";const B=v=>C({url:"/identity-service/describe-audit-logs",method:"post",data:v}),k={style:{"margin-bottom":"10px",height:"32px"}},F={style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},R=["innerHTML"],A={style:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},D=["innerHTML"],H={style:{"max-width":"90%"}},M={style:{"margin-top":"20px"}},U={style:{"margin-top":"20px"}},K={__name:"AuditLog",setup(v){const _=f({}),c=f(!1),t=f();function h(b){t.value=b,c.value=!0}return(b,d)=>{const E=i("ElLink"),r=i("ElTableColumn"),m=i("ElText"),n=i("ElFormItem"),u=i("ElCol"),w=i("ElTooltip"),x=i("ElRow"),V=i("ElForm");return L(),I(j,null,[p("div",k,[e(y(q),{style:{float:"right",width:"20%"},modelValue:_.value.search,"onUpdate:modelValue":d[0]||(d[0]=a=>_.value.search=a),"suffix-icon":"search"},null,8,["modelValue"])]),e(N,{"paging-request":_.value,"remote-method":y(B)},{default:l(()=>[e(r,{prop:"actionName",label:"操作名称",sortable:"custom"},{default:l(a=>[e(E,{onClick:()=>h(a.row),type:"primary"},{default:l(()=>[s(o(a.row.actionName),1)]),_:2},1032,["onClick"])]),_:1}),e(r,{prop:"objectTypeName",label:"对象类型",sortable:"custom"}),e(r,{prop:"objectNames",label:"对象",sortable:"custom"}),e(r,{prop:"level",label:"级别",sortable:"custom"},{default:l(a=>[e(m,{type:a.row.level==="info"?"info":a.row.level==="error"?"danger":"warning"},{default:l(()=>[s(o(a.row.level),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"userRealName",label:"操作人",sortable:"custom"}),e(r,{prop:"sourceIp",label:"源IP",sortable:"custom"}),e(r,{prop:"path",label:"请求路径",sortable:"custom"}),e(r,{prop:"statusCode",label:"响应码",sortable:"custom"},{default:l(a=>[e(m,{type:a.row.statusCode>=400?"danger":a.row.statusCode>=300?"warning":"success"},{default:l(()=>[s(o(a.row.statusCode),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"requestedAt",label:"时间",sortable:"custom"})]),_:1},8,["paging-request","remote-method"]),e(T,{modelValue:c.value,"onUpdate:modelValue":d[3]||(d[3]=a=>c.value=a),size:800,title:"日志详情"},{default:l(()=>[e(V,null,{default:l(()=>[e(x,{gutter:24},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"操作"},{default:l(()=>[s(o(t.value.actionName)+"("+o(t.value.action)+") ",1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"对象类型"},{default:l(()=>[s(o(t.value.objectTypeName)+"("+o(t.value.objectType)+") ",1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"对象名称"},{default:l(()=>[e(w,null,{content:l(()=>[p("span",{style:{"white-space":"pre-wrap"},innerHTML:t.value.objectNames},null,8,R)]),default:l(()=>[p("div",F,o(t.value.objectNames),1)]),_:1})]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"对象ID"},{default:l(()=>[e(w,null,{content:l(()=>[p("span",{style:{"white-space":"pre-wrap"},innerHTML:t.value.objectIds},null,8,D)]),default:l(()=>[p("div",A,o(t.value.objectIds),1)]),_:1})]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"日志级别"},{default:l(()=>[s(o(t.value.level),1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"请求ID"},{default:l(()=>[s(o(t.value.requestId),1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"操作人登录名"},{default:l(()=>[s(o(t.value.userLoginName),1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"操作人姓名"},{default:l(()=>[s(o(t.value.userRealName),1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"请求路径"},{default:l(()=>[s(o(t.value.path),1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"响应码"},{default:l(()=>[s(o(t.value.statusCode),1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"源IP"},{default:l(()=>[s(o(t.value.sourceIp),1)]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"请求时间"},{default:l(()=>[s(o(t.value.requestedAt),1)]),_:1})]),_:1})]),_:1})]),_:1}),p("div",H,[p("div",M,[e(m,null,{default:l(()=>[s("请求体")]),_:1}),e(g,{style:{"margin-top":"6px"},language:"json",modelValue:t.value.requestBody,"onUpdate:modelValue":d[1]||(d[1]=a=>t.value.requestBody=a),"read-only":""},null,8,["modelValue"])]),p("div",U,[e(m,null,{default:l(()=>[s("响应体")]),_:1}),e(g,{style:{"margin-top":"6px"},language:"json",modelValue:t.value.responseBody,"onUpdate:modelValue":d[2]||(d[2]=a=>t.value.responseBody=a),"read-only":""},null,8,["modelValue"])])])]),_:1},8,["modelValue"])],64)}}};export{K as default};
