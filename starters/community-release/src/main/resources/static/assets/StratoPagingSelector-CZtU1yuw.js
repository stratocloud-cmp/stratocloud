import{l as p}from"./request-BGZJNm7h.js";import{ab as q,r as o,a7 as K,y as M,m as b,n as z,o as g,q as F,Q as R,w as f,b0 as S,e as k,u as D,b1 as O,b as A,F as x,B as L}from"./index-C6PxR8iA.js";const I={__name:"StratoPagingSelector",props:q({remoteMethod:{required:!0},pagingRequest:{default:{},required:!1},defaultPageSize:{default:5,required:!1},labelGetter:{required:!0,type:Function},valueGetter:{required:!1,type:Function,default:u=>u.id},searchAttribute:{required:!1,default:"search"},disabled:{required:!1,default:!1},sortedBy:{required:!1,default:void 0},direction:{required:!1,default:void 0},disabledOptionFlagGetter:{required:!1,type:Function,default:()=>!1},placeholder:{required:!1},multiple:{required:!1,default:!1,type:Boolean},idFilterKey:{required:!1,default:void 0,type:String},multipleLimit:{required:!1,default:void 0,type:Number},allowCreate:{required:!1,default:!1,type:Boolean},teleported:{required:!1,default:!1,type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:q(["change"],["update:modelValue"]),setup(u,{emit:B}){const n=o(!1),i=K(u,"modelValue"),e=u;function P(){if(!e.multiple)return e.defaultPageSize;if(i.value instanceof Array){const t=i.value.length;return t<=e.defaultPageSize?e.defaultPageSize:t<=5?5:t<=10?10:t<=20?20:t<=50?50:100}return e.defaultPageSize}const l=o({current:1,size:P(),total:0,sortedBy:e.sortedBy,direction:e.direction}),c=o([]),v=o({});function w(){const t={current:l.value.current-1,size:l.value.size,sortedBy:l.value.sortedBy,direction:l.value.direction,...e.pagingRequest,...v.value};return e.idFilterKey&&(e.multiple?d.value?t[e.idFilterKey]=i.value:t[e.idFilterKey]=void 0:d.value&&i.value?t[e.idFilterKey]=[i.value]:t[e.idFilterKey]=void 0),e.remoteMethod(t).then(a=>{l.value.total=parseInt(a.totalElements),c.value=a.content,d.value&&h(i.value),n.value=!1}).catch(a=>{console.error(a),n.value=!1}).finally(()=>{d.value=!1})}const s=p.debounce(w,200),d=o(!1);M(()=>{n.value=!0,d.value=!0,s()});const m=o();b(()=>e.pagingRequest,()=>{p.isEqual(m.value,e.pagingRequest)||(m.value=p.cloneDeep(e.pagingRequest),n.value=!0,s())},{deep:!0}),b([()=>l.value.size,()=>l.value.current,()=>l.value.sortedBy,()=>l.value.direction],()=>{n.value=!0,s()});function E(t){v.value[e.searchAttribute]=t,n.value=!0,s()}const y=B;function G(t){for(let a of c.value)if(e.valueGetter(a)===t)return a}function h(t){t?y("change",G(t)):y("change",void 0)}return(t,a)=>{const V=z("ElOption"),C=z("ElSelect");return g(),F(C,{disabled:e.disabled,loading:n.value,modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=r=>i.value=r),filterable:"","filter-method":E,onChange:h,placeholder:u.placeholder,multiple:u.multiple,"multiple-limit":u.multipleLimit,"allow-create":u.allowCreate,teleported:u.teleported,clearable:""},R({footer:f(()=>[k(D(O),{style:{width:"100%",display:"flex","justify-content":"right"},"current-page":l.value.current,"onUpdate:currentPage":a[0]||(a[0]=r=>l.value.current=r),total:l.value.total,"page-size":l.value.size,"onUpdate:pageSize":a[1]||(a[1]=r=>l.value.size=r),onSizeChange:()=>{},"pager-count":11,size:"small",layout:"prev, pager, next, total"},null,8,["current-page","total","page-size"])]),default:f(()=>[(g(!0),A(x,null,L(c.value,r=>(g(),F(V,{key:e.valueGetter(r),label:e.labelGetter(r),value:e.valueGetter(r),disabled:e.disabledOptionFlagGetter(r)},{default:f(()=>[S(t.$slots,"default",{row:r})]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[t.$slots.header?{name:"header",fn:f(()=>[S(t.$slots,"header")]),key:"0"}:void 0]),1032,["disabled","loading","modelValue","placeholder","multiple","multiple-limit","allow-create","teleported"])}}};export{I as _};
