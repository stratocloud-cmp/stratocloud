import{d as T,b}from"./tag-BkRjwYLf.js";import{_ as k}from"./StratoPagingSelector-DNkLqj4O.js";import{ab as E,a7 as V,m as A,r as C,o as p,q as f,w as r,d as _,t as v,u as M,y as P,n as y,e as c,b as q,F as w,B as x,i as $}from"./index-CJwSUwqU.js";const I={style:{float:"left"}},D={style:{float:"right",color:"grey"}},F={__name:"TagValueSelector",props:E({tagEntryKey:{required:!0},tagEntryName:{required:!0}},{modelValue:{},modelModifiers:{},tagValueName:{},tagValueNameModifiers:{}}),emits:["update:modelValue","update:tagValueName"],setup(l){const g=V(l,"modelValue"),n=V(l,"tagValueName"),d=l;A(()=>d.tagEntryKey,()=>{u.value.tagEntryKey=d.tagEntryKey});const u=C({tagEntryKey:d.tagEntryKey});function s(t){n.value=t==null?void 0:t.tagValueName}return(t,N)=>(p(),f(k,{modelValue:g.value,"onUpdate:modelValue":N[0]||(N[0]=e=>g.value=e),"paging-request":u.value,"value-getter":e=>e.tagValue,"label-getter":e=>e.tagValueName,placeholder:`请选择${l.tagEntryName?l.tagEntryName:""}`,"remote-method":M(T),"sorted-by":"index",direction:"ASC","id-filter-key":"tagValues",onChange:s},{default:r(e=>[_("span",I,v(e.row.tagValueName),1),_("span",D,v(e.row.tagValue),1)]),_:1},8,["modelValue","paging-request","value-getter","label-getter","placeholder","remote-method"]))}},z={style:{float:"left"}},G={__name:"TagEntrySelector",props:E({pagingRequest:{required:!1,default:{}}},{modelValue:{},modelModifiers:{},tagKeyName:{},tagKeyNameModifiers:{}}),emits:["update:modelValue","update:tagKeyName"],setup(l){const g=V(l,"modelValue"),n=V(l,"tagKeyName");function d(u){n.value=u==null?void 0:u.tagKeyName}return(u,s)=>(p(),f(k,{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=t=>g.value=t),"paging-request":l.pagingRequest,"value-getter":t=>t.tagKey,"label-getter":t=>t.tagKeyName,placeholder:"请选择标签键","remote-method":M(b),"id-filter-key":"entryKeys",onChange:d},{default:r(t=>[_("span",z,v(t.row.tagKeyName),1)]),_:1},8,["modelValue","paging-request","value-getter","label-getter","remote-method"]))}},H={__name:"TagValueSelectorGroup",props:E({entryPagingRequest:{required:!0},span:{required:!1,default:12},defaultAddAllEntries:{required:!1,default:!0,type:Boolean}},{modelValue:{required:!0,type:Array,default:[]},modelModifiers:{}}),emits:["update:modelValue"],setup(l,{expose:g}){const n=V(l,"modelValue"),d=l,u=C([]);function s(e){n.value.push({tagKey:e.tagKey,tagKeyName:e.tagKeyName})}P(()=>{b({...d.entryPagingRequest,current:0,size:50}).then(e=>{if(u.value=e.content,d.defaultAddAllEntries)for(let o of u.value)n.value.some(m=>m.tagKey===o.tagKey)||s(o)})});function t(e){const o=n.value.indexOf(e);o>=0&&n.value.splice(o,1),console.log(n.value)}function N(e,o,m){if(!o||o.length===0)return m();for(let K of o)if(!K.tagKey||!K.tagValue)return m(new Error("标签未选择"));return m()}return g({validate:N}),(e,o)=>{const m=y("ElTag"),K=y("ElSpace"),U=y("ElInput"),h=y("ElCol"),S=y("ElRow"),B=y("ElButton"),R=y("ElPopover");return p(),f(R,{width:"450",trigger:"click",teleported:!1},{reference:r(()=>[c(U,{plain:"","suffix-icon":"ArrowDown"},{prefix:r(()=>[c(K,{alignment:"normal",wrap:""},{default:r(()=>[(p(!0),q(w,null,x(n.value,a=>(p(),f(m,{closable:"",onClose:()=>t(a)},{default:r(()=>[$(v((a.tagKeyName?a.tagKeyName:"?")+":"+(a.tagValueName?a.tagValueName:"?")),1)]),_:2},1032,["onClose"]))),256))]),_:1})]),_:1})]),default:r(()=>[_("div",null,[(p(!0),q(w,null,x(n.value,a=>(p(),f(S,{key:a.tagKey,gutter:12,style:{"margin-bottom":"6px"}},{default:r(()=>[c(h,{span:10},{default:r(()=>[c(G,{modelValue:a.tagKey,"onUpdate:modelValue":i=>a.tagKey=i,"tag-key-name":a.tagKeyName,"onUpdate:tagKeyName":i=>a.tagKeyName=i,"paging-request":l.entryPagingRequest},null,8,["modelValue","onUpdate:modelValue","tag-key-name","onUpdate:tagKeyName","paging-request"])]),_:2},1024),c(h,{span:14},{default:r(()=>[c(F,{modelValue:a.tagValue,"onUpdate:modelValue":i=>a.tagValue=i,"tag-value-name":a.tagValueName,"onUpdate:tagValueName":i=>a.tagValueName=i,"tag-entry-key":a.tagKey,"tag-entry-name":a.tagKeyName},null,8,["modelValue","onUpdate:modelValue","tag-value-name","onUpdate:tagValueName","tag-entry-key","tag-entry-name"])]),_:2},1024)]),_:2},1024))),128))]),c(B,{style:{width:"100%","margin-top":"6px"},icon:"Plus",onClick:o[0]||(o[0]=()=>s({}))})]),_:1})}}};export{H as _};
