import{_ as T}from"./StratoTable-EZs1qWj6.js";import{e as $,b as A,c as F,d as q,a as z,f as M}from"./DeleteUserGroupsForm-BCHkw36A.js";import{S as B}from"./StratoButton-BRlR7RNE.js";import{_ as k}from"./StratoDrawer-i3nJdUbZ.js";import{c as E}from"./job-P3tzUzyD.js";import{u as w}from"./activeJob-Bh-nGf5g.js";import{l as x}from"./request-IeLrxslB.js";import{r as a,o as m,b as C,e as o,w as d,i as j,q as y,v as R,F as I,n as J,a6 as O,d as h,u as U,f as N,P as G}from"./index-CJwSUwqU.js";import{_ as L}from"./User-B_B6jeMM.js";import"./TenantTreeSelector-cjxWtDlB.js";import"./TagValueSelectorGroup-BLl39_D0.js";import"./tag-BkRjwYLf.js";import"./StratoPagingSelector-DNkLqj4O.js";import"./UserSelector-CoJSGQ4A.js";import"./user-Ce1W_vfQ.js";import"./UpdateUserForm-DsLQM17h.js";import"./role-DMNZ0gjB.js";const H={__name:"CreateUserGroupButton",emits:["confirm"],setup(b,{emit:v}){const c=w(),l=a(!1),t=a(!1);function u(){n.value=x.cloneDeep(i),l.value=!0}const i={tenantId:void 0,name:void 0,alias:void 0,description:void 0,tags:[]},n=a(x.cloneDeep(i)),f=a(),_=v;function s(){f.value.validate(r=>{r&&(t.value=!0,E({jobType:"CREATE_USER_GROUP",jobParameters:n.value}).then(e=>{l.value=!1,c.setActiveJobId(e.jobId),_("confirm")}).finally(()=>{t.value=!1}))})}return(r,e)=>(m(),C(I,null,[o(B,{type:"primary",onClick:u},{default:d(()=>[j("创建")]),_:1}),o(k,{modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=p=>l.value=p),title:"创建用户组",onOnConfirm:s,loading:t.value,size:"600"},{default:d(()=>[l.value?(m(),y($,{key:0,ref_key:"formRef",ref:f,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=p=>n.value=p)},null,8,["modelValue"])):R("",!0)]),_:1},8,["modelValue","loading"])],64))}},K={__name:"UpdateUserGroupButton",props:{selectedGroups:{type:Array,required:!0}},emits:["confirm"],setup(b,{emit:v}){const c=w(),l=b,t=a(!1),u=a(!1);function i(){l.selectedGroups.length!==0&&(n.value.userGroupId=l.selectedGroups[0].id,t.value=!0)}const n=a({}),f=a(),_=v;function s(){f.value.validate(r=>{r&&(u.value=!0,E({jobType:"UPDATE_USER_GROUP",jobParameters:n.value}).then(e=>{t.value=!1,c.setActiveJobId(e.jobId),_("confirm")}).finally(()=>{u.value=!1}))})}return(r,e)=>{const p=J("ElButton");return m(),C(I,null,[o(p,{type:"primary",link:"",onClick:i},{default:d(()=>[j("更新")]),_:1}),(m(),y(O,{to:"body"},[o(k,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=D=>t.value=D),title:"更新用户组",onOnConfirm:s,loading:u.value,size:"600"},{default:d(()=>[t.value?(m(),y(A,{key:0,ref_key:"formRef",ref:f,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=D=>n.value=D)},null,8,["modelValue"])):R("",!0)]),_:1},8,["modelValue","loading"])]))],64)}}},Q={__name:"JoinUserGroupButton",emits:["confirm"],setup(b,{emit:v}){const c=w(),l=a(!1),t=a(!1);function u(){i.value={},l.value=!0}const i=a({}),n=a(),f=v;function _(){n.value.validate(s=>{s&&(t.value=!0,E({jobType:"JOIN_USER_GROUP",jobParameters:i.value}).then(r=>{l.value=!1,c.setActiveJobId(r.jobId),f("confirm")}).finally(()=>{t.value=!1}))})}return(s,r)=>{const e=J("ElButton");return m(),C(I,null,[o(e,{onClick:u,type:"primary",link:""},{default:d(()=>[j("找不到期望的用户组? 点击此处申请加入")]),_:1}),o(k,{modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=p=>l.value=p),title:"申请加入用户组",onOnConfirm:_,loading:t.value},{default:d(()=>[l.value?(m(),y(F,{key:0,ref_key:"formRef",ref:n,modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=p=>i.value=p)},null,8,["modelValue"])):R("",!0)]),_:1},8,["modelValue","loading"])],64)}}},W=h("span",{style:{"font-size":"12px"}},"邀请新成员",-1),X=h("span",{style:{"font-size":"12px"}},"移除成员",-1),Y={__name:"MembersButton",props:{selectedGroups:{type:Array,required:!0}},setup(b){const v=w(),c=b,l=a(!1),t=a(),u=a();function i(){c.selectedGroups.length!==0&&(t.value=c.selectedGroups[0],l.value=!0)}const n=a([]);function f(g){n.value=g}function _(){E({jobType:"REMOVE_USERS_FROM_GROUP",jobParameters:{userGroupId:t.value.id,userIds:n.value.map(g=>g.id)}}).then(g=>{v.setActiveJobId(g.jobId),u.value.fetchData()})}const s=a({userGroupId:void 0,userIds:[]}),r=a(),e=a(!1);function p(){s.value.userGroupId=t.value.id,e.value=!0}function D(){r.value.validate(g=>{g&&E({jobType:"INVITE_USERS_TO_GROUP",jobParameters:s.value}).then(V=>{e.value=!1,v.setActiveJobId(V.jobId),u.value.fetchData()})})}return(g,V)=>{const P=J("ElButton");return m(),C(I,null,[o(P,{type:"primary",onClick:i,link:""},{default:d(()=>[j("成员管理")]),_:1}),(m(),y(O,{to:"body"},[o(k,{size:800,modelValue:l.value,"onUpdate:modelValue":V[0]||(V[0]=S=>l.value=S),title:"成员管理","no-confirm":""},{default:d(()=>[l.value?(m(),y(L,{key:0,"simple-mode":"","user-group-ids":[t.value.id],onChange:f,ref_key:"tableRef",ref:u},{buttons:d(()=>[o(B,{size:"small",type:"success",plain:"",onClick:p},{default:d(()=>[W]),_:1}),o(B,{size:"small",type:"danger",plain:"",disabled:n.value.length===0,onClick:_},{default:d(()=>[X]),_:1},8,["disabled"])]),_:1},8,["user-group-ids"])):R("",!0)]),_:1},8,["modelValue"]),o(k,{modelValue:e.value,"onUpdate:modelValue":V[2]||(V[2]=S=>e.value=S),title:"邀请新成员",onOnConfirm:D},{default:d(()=>[o(q,{ref_key:"inviteFormRef",ref:r,modelValue:s.value,"onUpdate:modelValue":V[1]||(V[1]=S=>s.value=S)},null,8,["modelValue"])]),_:1},8,["modelValue"])]))],64)}}},Z={__name:"DeleteUserGroupsButton",props:{selectedGroups:{type:Array,required:!0}},emits:["confirm"],setup(b,{emit:v}){const c=w(),l=b,t=a(!1),u=a(!1);function i(){l.selectedGroups.length!==0&&(n.value.userGroupIds=l.selectedGroups.map(r=>r.id),t.value=!0)}const n=a({}),f=a(),_=v;function s(){f.value.validate(r=>{r&&(u.value=!0,E({jobType:"DELETE_USER_GROUPS",jobParameters:n.value}).then(e=>{t.value=!1,c.setActiveJobId(e.jobId),_("confirm")}).finally(()=>{u.value=!1}))})}return(r,e)=>(m(),C(I,null,[o(B,{disabled:b.selectedGroups.length===0,plain:"",type:"danger",onClick:i},{default:d(()=>[j("删除")]),_:1},8,["disabled"]),(m(),y(O,{to:"body"},[o(k,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=p=>t.value=p),title:"删除用户组",onOnConfirm:s,loading:u.value,size:"600"},{default:d(()=>[t.value?(m(),y(z,{key:0,ref_key:"formRef",ref:f,modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=p=>n.value=p)},null,8,["modelValue"])):R("",!0)]),_:1},8,["modelValue","loading"])]))],64))}},ee={style:{"margin-bottom":"10px"}},ye={__name:"UserGroup",props:{simpleMode:{default:!1,required:!1}},setup(b){const v=b,c=a({}),l=a([]);function t(n){l.value=n}const u=a();function i(){u.value.fetchData()}return(n,f)=>{const _=J("ElSpace");return m(),C(I,null,[h("div",ee,[v.simpleMode?R("",!0):(m(),y(_,{key:0,alignment:"normal"},{default:d(()=>[o(H,{onConfirm:i}),o(Z,{"selected-groups":l.value,onConfirm:i},null,8,["selected-groups"]),o(Q)]),_:1})),o(U(N),{style:{float:"right",width:"20%"},modelValue:c.value.search,"onUpdate:modelValue":f[0]||(f[0]=s=>c.value.search=s),"suffix-icon":"search"},null,8,["modelValue"])]),o(T,{ref_key:"tableRef",ref:u,"paging-request":c.value,"remote-method":U(M),onSelectionChange:t},{default:d(()=>[v.simpleMode?R("",!0):(m(),y(U(G),{key:0,type:"selection","reserve-selection":""})),o(U(G),{prop:"name",label:"名称",sortable:"custom"}),o(U(G),{prop:"alias",label:"别名",sortable:"custom"}),o(U(G),{prop:"description",label:"描述"}),o(U(G),{prop:"createdAt",label:"创建时间",sortable:"custom"}),o(U(G),null,{default:d(s=>[o(K,{"selected-groups":[s.row],onConfirm:i},null,8,["selected-groups"]),o(Y,{"selected-groups":[s.row]},null,8,["selected-groups"])]),_:1})]),_:1},8,["paging-request","remote-method"])],64)}}};export{ye as default};
