import{ab as w,a7 as g,r as b,o as s,q as m,w as a,d as p,t as h,u as F,y as M,b as C,F as $,e as c,v as y,a9 as B,G as H,H as A,aa as O,n as f,i as x,ae as T,a_ as j,m as N,B as R,I as L}from"./index-CJwSUwqU.js";import{g as z,k as J,_ as P,d as G}from"./IpState-C6MgozXE.js";import{_ as W}from"./UserSelector-CoJSGQ4A.js";import{_}from"./StratoPagingSelector-DNkLqj4O.js";import{d as Y}from"./role-DMNZ0gjB.js";import{a as K}from"./job-P3tzUzyD.js";import{d as Q}from"./scriptDefinition-YE6MXqAV.js";const X={style:{float:"left"}},Z={style:{float:"right",color:"grey"}},ee={__name:"RoleSelector",props:w({placeholder:{required:!1},multiple:{required:!1,default:!1,type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=b({});return(r,i)=>(s(),m(_,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=o=>l.value=o),"paging-request":t.value,"label-getter":o=>o.name,placeholder:e.placeholder,"remote-method":F(Y),multiple:e.multiple,"id-filter-key":"roleIds"},{default:a(o=>[p("span",X,h(o.row.name),1),p("span",Z,h(o.row.type),1)]),_:1},8,["modelValue","paging-request","label-getter","placeholder","remote-method","multiple"]))}},le={style:{float:"left"}},te={style:{float:"right",color:"grey"}},oe={__name:"JobDefinitionSelector",props:w({placeholder:{required:!1},multiple:{required:!1,default:!1,type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=b({});return(r,i)=>(s(),m(_,{modelValue:l.value,"onUpdate:modelValue":i[0]||(i[0]=o=>l.value=o),"paging-request":t.value,"label-getter":o=>o.jobTypeName,"value-getter":o=>o.jobType,placeholder:e.placeholder,"remote-method":F(K),multiple:e.multiple,"id-filter-key":"jobTypes"},{default:a(o=>[p("span",le,h(o.row.jobTypeName),1),p("span",te,h(o.row.jobType),1)]),_:1},8,["modelValue","paging-request","label-getter","value-getter","placeholder","remote-method","multiple"]))}},ne={__name:"ScriptDefinitionSelector",emits:["change"],setup(e,{emit:l}){const t=b(),r=l;function i(o){r("change",o)}return(o,u)=>(s(),m(_,{modelValue:t.value,"onUpdate:modelValue":u[0]||(u[0]=n=>t.value=n),"label-getter":n=>n.name,"remote-method":F(Q),onChange:i},null,8,["modelValue","label-getter","remote-method"]))}},ae={style:{width:"100%"}},ie={__name:"ScriptDefinitionWrappedSelector",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=b();function r(i){i&&i.remoteScriptDef&&(t.value=i.remoteScriptDef.customFormMetaData)}return M(()=>{console.log(l.value)}),(i,o)=>(s(),C("div",ae,[l.value?(s(),C($,{key:0},[c(ne,{onChange:r,modelValue:l.value.scriptDefinitionId,"onUpdate:modelValue":o[0]||(o[0]=u=>l.value.scriptDefinitionId=u)},null,8,["modelValue"]),t.value&&l.value.customFormData?(s(),m(we,{key:0,style:{"margin-top":"12px"},"form-meta-data":t.value,modelValue:l.value.customFormData,"onUpdate:modelValue":o[1]||(o[1]=u=>l.value.customFormData=u)},null,8,["form-meta-data","modelValue"])):y("",!0)],64)):y("",!0)]))}};function de(e){switch(e){case"USER":return W;case"ROLE":return ee;case"JOB_DEFINITION":return oe;case"SCRIPT_DEFINITION":return ie}return H({setup(){return()=>A("div",{},"Unknown entity type:"+e)}})}class U{constructor(l){this.formDataRef=l,this.args={}}isConditionsMatched(l){if(!l||l.length===0)return!0;for(let t of l)if(!{...this.formDataRef.value,isMatched:new Function("args","return "+t)}.isMatched(this.args))return!1;return!0}setArg(l,t){this.args[l]=t}setArgs(l){if(l)for(let t in l)this.setArg(t,l[t])}}function ue(e){const l=new U(e);return B("dynamicFormContext",l),l}function q(){return O("dynamicFormContext",new U({}))}const re=["innerHTML"],se={__name:"DynamicFormInput",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{defaultValue:void 0,required:void 0,conditions:[],regex:void 0,regexMessage:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,r=b([]);M(()=>{var u,n,d;(u=t.fieldInfo.detail)!=null&&u.defaultValue&&!l.value&&(l.value=t.fieldInfo.detail.defaultValue),(n=t.fieldInfo.detail)!=null&&n.required&&r.value.push({required:!0,message:"请输入"+t.fieldInfo.label}),(d=t.fieldInfo.detail)!=null&&d.regex&&r.value.push({validator:z(t.fieldInfo.detail.regex,t.fieldInfo.detail.regexMessage),trigger:["blur","change"]})});const i=q();function o(){return i.isConditionsMatched(t.fieldInfo.detail.conditions)}return(u,n)=>{const d=f("ElIcon"),v=f("ElTooltip"),V=f("ElInput"),I=f("ElFormItem");return o()?(s(),m(I,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:r.value},{label:a(()=>[p("span",null,[x(h(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(v,{key:0},{content:a(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,re)]),default:a(()=>[c(d,{style:{cursor:"pointer"}},{default:a(()=>[c(F(T))]),_:1})]),_:1})):y("",!0)])]),default:a(()=>{var k,D,E;return[c(V,{type:(k=e.fieldInfo.detail)==null?void 0:k.inputType,"show-password":((D=e.fieldInfo.detail)==null?void 0:D.inputType)==="password",autocomplete:((E=e.fieldInfo.detail)==null?void 0:E.inputType)==="password"?"new-password":"off",modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=S=>l.value=S)},null,8,["type","show-password","autocomplete","modelValue"])]}),_:1},8,["prop","label","rules"])):y("",!0)}}},fe=["innerHTML"],me={key:2},ce={__name:"DynamicFormSelect",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{multiSelect:!1,defaultValues:[],options:[],optionNames:[],source:void 0,entityType:void 0,dependsOn:[],required:!0,conditions:[],type:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,r=b([]),i=j();N(t,()=>{var n,d;(n=t.fieldInfo.detail)!=null&&n.defaultValues&&t.fieldInfo.detail.defaultValues.length>0&&!l.value&&(t.fieldInfo.detail.multiSelect?l.value=t.fieldInfo.detail.defaultValues:l.value=t.fieldInfo.detail.defaultValues[0]),(d=t.fieldInfo.detail)!=null&&d.required&&r.value.push({required:!0,message:"请选择"+t.fieldInfo.label}),t.fieldInfo.detail.source==="ENTITY"&&(i.value=de(t.fieldInfo.detail.entityType))},{immediate:!0});const o=q();function u(){return o.isConditionsMatched(t.fieldInfo.detail.conditions)}return(n,d)=>{const v=f("ElIcon"),V=f("ElTooltip"),I=f("ElOption"),k=f("ElSelect"),D=f("ElFormItem");return u()?(s(),m(D,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:r.value},{label:a(()=>[p("span",null,[x(h(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(V,{key:0},{content:a(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,fe)]),default:a(()=>[c(v,{style:{cursor:"pointer"}},{default:a(()=>[c(F(T))]),_:1})]),_:1})):y("",!0)])]),default:a(()=>[e.fieldInfo.detail.source==="STATIC"?(s(),m(k,{key:0,modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=E=>l.value=E),filterable:"",multiple:e.fieldInfo.detail.multiSelect,"allow-create":e.fieldInfo.detail.allowCreate,placeholder:"请选择"+e.fieldInfo.label},{default:a(()=>[(s(!0),C($,null,R(e.fieldInfo.detail.options,(E,S)=>(s(),m(I,{key:E,value:E,label:e.fieldInfo.detail.optionNames[S]},null,8,["value","label"]))),128))]),_:1},8,["modelValue","multiple","allow-create","placeholder"])):i.value?(s(),m(L(i.value),{key:1,modelValue:l.value,"onUpdate:modelValue":d[1]||(d[1]=E=>l.value=E),multiple:e.fieldInfo.detail.multiSelect,placeholder:"请选择"+e.fieldInfo.label},null,8,["modelValue","multiple","placeholder"])):(s(),C("div",me,"Unknown options source: "+h(e.fieldInfo.detail.source),1))]),_:1},8,["prop","label","rules"])):y("",!0)}}},pe=["innerHTML"],Ie={__name:"DynamicFormNumber",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{defaultValue:void 0,required:void 0,conditions:[],min:void 0,max:void 0,placeholder:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,r=b([]);M(()=>{var u,n;(u=t.fieldInfo.detail)!=null&&u.defaultValue&&!l.value&&(l.value=t.fieldInfo.detail.defaultValue),(n=t.fieldInfo.detail)!=null&&n.required&&r.value.push({required:!0,message:"请输入"+t.fieldInfo.label})});const i=q();function o(){return i.isConditionsMatched(t.fieldInfo.detail.conditions)}return(u,n)=>{const d=f("ElIcon"),v=f("ElTooltip"),V=f("ElInputNumber"),I=f("ElFormItem");return o()?(s(),m(I,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:r.value},{label:a(()=>[p("span",null,[x(h(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(v,{key:0},{content:a(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,pe)]),default:a(()=>[c(d,{style:{cursor:"pointer"}},{default:a(()=>[c(F(T))]),_:1})]),_:1})):y("",!0)])]),default:a(()=>[c(V,{style:{width:"100%"},modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=k=>l.value=k),min:e.fieldInfo.detail.min,max:e.fieldInfo.detail.max,placeholder:e.fieldInfo.detail.placeholder},null,8,["modelValue","min","max","placeholder"])]),_:1},8,["prop","label","rules"])):y("",!0)}}},ye=["innerHTML"],Ve={__name:"DynamicFormBoolean",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{defaultValue:void 0,conditions:[]}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e;M(()=>{var o;((o=t.fieldInfo.detail)==null?void 0:o.defaultValue)!==void 0&&l.value===void 0&&(l.value=t.fieldInfo.detail.defaultValue)});const r=q();function i(){return r.isConditionsMatched(t.fieldInfo.detail.conditions)}return(o,u)=>{const n=f("ElIcon"),d=f("ElTooltip"),v=f("ElSwitch"),V=f("ElFormItem");return i()?(s(),m(V,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label},{label:a(()=>[p("span",null,[x(h(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(d,{key:0},{content:a(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,ye)]),default:a(()=>[c(n,{style:{cursor:"pointer"}},{default:a(()=>[c(F(T))]),_:1})]),_:1})):y("",!0)])]),default:a(()=>[c(v,{style:{width:"100%"},modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=I=>l.value=I)},null,8,["modelValue"])]),_:1},8,["prop","label"])):y("",!0)}}},he={style:{float:"left"}},ve={style:{float:"right",color:"grey"}},ge={__name:"IpSelector",props:w({placeholder:{required:!1},protocol:{required:!1},multipleLimit:{required:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),r=b({protocol:e.protocol}),i=J();return N(i.networkResourceId,()=>{r.value.networkResourceId=i.networkResourceId.value}),(o,u)=>(s(),m(_,{modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=n=>l.value=n),"paging-request":r.value,"label-getter":n=>n.address,"value-getter":n=>n.address,"disabled-option-flag-getter":n=>n.state!=="AVAILABLE",placeholder:e.placeholder,"remote-method":F(G),multiple:"","multiple-limit":e.multipleLimit,"allow-create":"","sorted-by":"toBigInteger",direction:"ASC","id-filter-key":"ips",teleported:""},{default:a(n=>[p("span",he,h(n.row.address),1),p("span",ve,[c(P,{state:n.row.state},null,8,["state"])])]),_:1},8,["modelValue","paging-request","label-getter","value-getter","disabled-option-flag-getter","placeholder","remote-method","multiple-limit"]))}},be=["innerHTML"],Ee={__name:"DynamicFormIp",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{multipleLimit:void 0,protocol:void 0,required:void 0,conditions:[],placeholder:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,r=b([]);M(()=>{var u;(u=t.fieldInfo.detail)!=null&&u.required&&r.value.push({required:!0,message:"请选择"+t.fieldInfo.label})});const i=q();function o(){return i.isConditionsMatched(t.fieldInfo.detail.conditions)}return(u,n)=>{const d=f("ElIcon"),v=f("ElTooltip"),V=f("ElFormItem");return o()?(s(),m(V,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:r.value},{label:a(()=>[p("span",null,[x(h(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(v,{key:0},{content:a(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,be)]),default:a(()=>[c(d,{style:{cursor:"pointer"}},{default:a(()=>[c(F(T))]),_:1})]),_:1})):y("",!0)])]),default:a(()=>[c(ge,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=I=>l.value=I),"multiple-limit":e.fieldInfo.detail.multipleLimit,protocol:e.fieldInfo.detail.protocol,placeholder:e.fieldInfo.detail.placeholder},null,8,["modelValue","multiple-limit","protocol","placeholder"])]),_:1},8,["prop","label","rules"])):y("",!0)}}},we={__name:"StratoDynamicForm",props:w({formMetaData:{required:!0,default:{formClass:void 0,fieldInfoList:[]}},size:{required:!1,default:"default",options:["small","default","large",""]},args:{required:!1,default:{}}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(e,{expose:l}){const t=e,r=b();l({validate:i});function i(d){r.value.validate(d)}const o=g(e,"modelValue");function u(d){switch(d){case"InputField":return se;case"SelectField":return ce;case"NumberField":return Ie;case"BooleanField":return Ve;case"IpField":return Ee}}ue(o).setArgs(t.args);for(let d of t.formMetaData.fieldInfoList)d.type==="SelectField"&&d.detail&&d.detail.entityType==="SCRIPT_DEFINITION"&&(o.value[d.key]||(o.value[d.key]={customFormData:{}}));return(d,v)=>{const V=f("ElForm");return s(),m(V,{size:e.size,ref_key:"formRef",ref:r,model:o.value,"label-position":"top","hide-required-asterisk":""},{default:a(()=>[(s(!0),C($,null,R(e.formMetaData.fieldInfoList,I=>(s(),m(L(u(I.type)),{modelValue:o.value[I.key],"onUpdate:modelValue":k=>o.value[I.key]=k,"field-info":I},null,8,["modelValue","onUpdate:modelValue","field-info"]))),256))]),_:1},8,["size","model"])}}};export{we as _};
