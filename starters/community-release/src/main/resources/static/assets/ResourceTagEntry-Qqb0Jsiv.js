import{_ as S}from"./StratoTable--zpPaOW_.js";import{d as M,a as P,r as j,c as H,u as J,b as L,e as Q}from"./tag-CWCUpvbv.js";import{S as x}from"./StratoButton-D7m4JR2l.js";import{_ as W}from"./StratoDrawer-BQ9z9CYD.js";import{r as d,n as m,o as N,b as I,e,w as l,i as y,d as k,q as G,u as p,O as B,v as z,f as K,F as w,t as X,P as U}from"./index-C_jnbPMf.js";import{_ as A}from"./CategorySelector-Cv_x1LAY.js";import"./request-BV6gXtmx.js";import"./StratoSelector-Csy36wxr.js";import"./resource-DdTtSOFP.js";const Y={style:{"margin-bottom":"10px",height:"32px"}},Z=k("span",{style:{"font-size":"12px"}},"新建标签值",-1),ee=k("span",{style:{"font-size":"12px"}},"删除标签值",-1),le={__name:"TagValuesButton",props:{selectedEntries:{type:Array,required:!0}},setup(q){const b=q,f=d(),o=d(),a=d(!1);function _(){b.selectedEntries.length!==0&&(o.value=b.selectedEntries[0],s.value.tagEntryKey=b.selectedEntries[0].tagKey,a.value=!0)}const s=d({}),C=d([]);function E(V){C.value=V}const v=d(!1),r=d(),i=d({}),u=d({tagValue:[{required:!0,message:"请输入标签值"}],tagValueName:[{required:!0,message:"请输入标签值名称"}],index:[{required:!0,message:"请输入序号"}]});function g(){i.value.tagEntryId=o.value.id,v.value=!0}function h(){r.value.validate(V=>{V&&P(i.value).then(()=>{f.value.fetchData(),v.value=!1})})}function F(){j({tagEntryId:o.value.id,tagValueIds:C.value.map(V=>V.id)}).then(()=>{f.value.fetchData()})}return(V,t)=>{var D;const R=m("ElSpace"),n=m("ElTableColumn"),T=m("ElFormItem"),$=m("ElInputNumber"),O=m("ElForm");return N(),I(w,null,[e(x,{disabled:q.selectedEntries.length!==1,"disabled-message":"请选择并只选择一项",onClick:_,plain:""},{default:l(()=>[y("管理标签值")]),_:1},8,["disabled"]),e(W,{modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=c=>a.value=c),title:(D=o.value)==null?void 0:D.tagKeyName,"no-confirm":"",size:800},{default:l(()=>[k("div",Y,[b.simpleMode?z("",!0):(N(),G(R,{key:0,alignment:"normal"},{default:l(()=>[e(x,{type:"success",plain:"",size:"small",onClick:g},{default:l(()=>[Z]),_:1}),e(p(B),{title:"确认删除?",onConfirm:F},{reference:l(()=>[e(x,{disabled:C.value.length===0,type:"danger",plain:"",size:"small"},{default:l(()=>[ee]),_:1},8,["disabled"])]),_:1})]),_:1})),e(p(K),{style:{float:"right",width:"20%"},modelValue:s.value.search,"onUpdate:modelValue":t[0]||(t[0]=c=>s.value.search=c),"suffix-icon":"search"},null,8,["modelValue"])]),e(S,{ref_key:"tableRef",ref:f,"paging-request":s.value,"remote-method":p(M),onSelectionChange:E,"sorted-by":"index",direction:"ASC"},{default:l(()=>[e(n,{type:"selection","reserve-selection":""}),e(n,{prop:"tagValue",label:"标签键",sortable:"custom"}),e(n,{prop:"tagValueName",label:"标签键名称",sortable:"custom"}),e(n,{prop:"description",label:"描述"}),e(n,{prop:"createdAt",label:"创建时间",sortable:"custom"})]),_:1},8,["paging-request","remote-method"])]),_:1},8,["modelValue","title"]),e(W,{modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=c=>v.value=c),title:"新建标签值",onOnConfirm:h},{default:l(()=>[e(O,{ref_key:"addValueFormRef",ref:r,model:i.value,rules:u.value,"label-position":"top"},{default:l(()=>[e(T,{prop:"tagValue",label:"标签值"},{default:l(()=>[e(p(K),{placeholder:"请输入标签值",modelValue:i.value.tagValue,"onUpdate:modelValue":t[2]||(t[2]=c=>i.value.tagValue=c)},null,8,["modelValue"])]),_:1}),e(T,{prop:"tagValueName",label:"标签值名称"},{default:l(()=>[e(p(K),{placeholder:"请输入标签值名称",modelValue:i.value.tagValueName,"onUpdate:modelValue":t[3]||(t[3]=c=>i.value.tagValueName=c)},null,8,["modelValue"])]),_:1}),e(T,{prop:"index",label:"序号"},{default:l(()=>[e($,{style:{width:"100%"},min:0,placeholder:"请输入序号",modelValue:i.value.index,"onUpdate:modelValue":t[4]||(t[4]=c=>i.value.index=c)},null,8,["modelValue"])]),_:1}),e(T,{prop:"description",label:"描述"},{default:l(()=>[e(p(K),{type:"textarea",placeholder:"请输入描述",modelValue:i.value.description,"onUpdate:modelValue":t[5]||(t[5]=c=>i.value.description=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},ae={__name:"CreateEntryButton",emits:["confirm"],setup(q,{emit:b}){const f=d(),o=d({tagKey:void 0,tagKeyName:void 0,resourceCategory:void 0,requiredWhenCreating:!0,requiredWhenFiltering:!0,userGroupTaggable:!1}),a=d(!1);function _(){a.value=!0}const s=d({tagKey:[{required:!0,message:"请输入标签键"}],tagKeyName:[{required:!0,message:"请输入标签键名称"}]}),C=b;function E(){f.value.validate(v=>{v&&H(o.value).then(r=>{a.value=!1,C("confirm")})})}return(v,r)=>{const i=m("ElInput"),u=m("ElFormItem"),g=m("ElCheckbox"),h=m("ElCol"),F=m("ElRow"),V=m("ElForm");return N(),I(w,null,[e(x,{type:"primary",plain:"",onClick:_},{default:l(()=>[y("创建")]),_:1}),e(W,{title:"创建标签键",modelValue:a.value,"onUpdate:modelValue":r[7]||(r[7]=t=>a.value=t),size:"600",onOnConfirm:E},{default:l(()=>[e(V,{ref_key:"formRef",ref:f,model:o.value,rules:s.value,"label-position":"top"},{default:l(()=>[e(u,{prop:"tagKey",label:"标签键"},{default:l(()=>[e(i,{placeholder:"请输入标签键",modelValue:o.value.tagKey,"onUpdate:modelValue":r[0]||(r[0]=t=>o.value.tagKey=t)},null,8,["modelValue"])]),_:1}),e(u,{prop:"tagKeyName",label:"标签键名称"},{default:l(()=>[e(i,{placeholder:"请输入标签键名称",modelValue:o.value.tagKeyName,"onUpdate:modelValue":r[1]||(r[1]=t=>o.value.tagKeyName=t)},null,8,["modelValue"])]),_:1}),e(u,{prop:"resourceCategory",label:"所作用的资源类型"},{default:l(()=>[e(A,{modelValue:o.value.resourceCategory,"onUpdate:modelValue":r[2]||(r[2]=t=>o.value.resourceCategory=t),placeholder:"留空代表作用于所有资源类型"},null,8,["modelValue"])]),_:1}),e(F,null,{default:l(()=>[e(h,{span:8},{default:l(()=>[e(u,{prop:"requiredWhenCreating"},{default:l(()=>[e(g,{modelValue:o.value.requiredWhenCreating,"onUpdate:modelValue":r[3]||(r[3]=t=>o.value.requiredWhenCreating=t)},{default:l(()=>[y(" 创建资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:l(()=>[e(u,{prop:"requiredWhenFiltering"},{default:l(()=>[e(g,{modelValue:o.value.requiredWhenFiltering,"onUpdate:modelValue":r[4]||(r[4]=t=>o.value.requiredWhenFiltering=t)},{default:l(()=>[y(" 筛选资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(h,{span:8},{default:l(()=>[e(u,{prop:"userGroupTaggable"},{default:l(()=>[e(g,{modelValue:o.value.userGroupTaggable,"onUpdate:modelValue":r[5]||(r[5]=t=>o.value.userGroupTaggable=t)},{default:l(()=>[y(" 用户组中可选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(u,{prop:"description",label:"描述"},{default:l(()=>[e(i,{type:"textarea",modelValue:o.value.description,"onUpdate:modelValue":r[6]||(r[6]=t=>o.value.description=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},te={__name:"UpdateEntryButton",props:{selectedEntries:{required:!0,type:Array}},emits:["confirm"],setup(q,{emit:b}){const f=q,o=d(),a=d({tagEntryId:void 0,tagKeyName:void 0,description:void 0,resourceCategory:void 0,requiredWhenCreating:!0,requiredWhenFiltering:!0,userGroupTaggable:!1}),_=d(!1),s=d();function C(){f.selectedEntries.length!==0&&(s.value=f.selectedEntries[0],a.value.tagEntryId=s.value.id,a.value.tagKeyName=s.value.tagKeyName,a.value.resourceCategory=s.value.resourceCategory,a.value.requiredWhenCreating=s.value.requiredWhenCreating,a.value.requiredWhenFiltering=s.value.requiredWhenFiltering,a.value.userGroupTaggable=s.value.userGroupTaggable,a.value.description=s.value.description,_.value=!0)}const E=d({tagKeyName:[{required:!0,message:"请输入标签键名称"}]}),v=b;function r(){o.value.validate(i=>{i&&J(a.value).then(u=>{_.value=!1,v("confirm")})})}return(i,u)=>{const g=m("ElFormItem"),h=m("ElInput"),F=m("ElCheckbox"),V=m("ElCol"),t=m("ElRow"),R=m("ElForm");return N(),I(w,null,[e(x,{plain:"",onClick:C,disabled:q.selectedEntries.length!==1,"disabled-message":"请选择并只选择一项"},{default:l(()=>[y(" 更新 ")]),_:1},8,["disabled"]),e(W,{title:"更新标签键",modelValue:_.value,"onUpdate:modelValue":u[6]||(u[6]=n=>_.value=n),size:"600",onOnConfirm:r},{default:l(()=>[e(R,{ref_key:"formRef",ref:o,model:a.value,rules:E.value,"label-position":"top"},{default:l(()=>[e(g,{prop:"tagKey",label:"标签键"},{default:l(()=>{var n;return[y(X((n=s.value)==null?void 0:n.tagKey),1)]}),_:1}),e(g,{prop:"tagKeyName",label:"标签键名称"},{default:l(()=>[e(h,{placeholder:"请输入标签键名称",modelValue:a.value.tagKeyName,"onUpdate:modelValue":u[0]||(u[0]=n=>a.value.tagKeyName=n)},null,8,["modelValue"])]),_:1}),e(g,{prop:"resourceCategory",label:"所作用的资源类型"},{default:l(()=>[e(A,{modelValue:a.value.resourceCategory,"onUpdate:modelValue":u[1]||(u[1]=n=>a.value.resourceCategory=n),placeholder:"留空代表作用于所有资源类型"},null,8,["modelValue"])]),_:1}),e(t,null,{default:l(()=>[e(V,{span:8},{default:l(()=>[e(g,{prop:"requiredWhenCreating"},{default:l(()=>[e(F,{modelValue:a.value.requiredWhenCreating,"onUpdate:modelValue":u[2]||(u[2]=n=>a.value.requiredWhenCreating=n)},{default:l(()=>[y(" 创建资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:l(()=>[e(g,{prop:"requiredWhenFiltering"},{default:l(()=>[e(F,{modelValue:a.value.requiredWhenFiltering,"onUpdate:modelValue":u[3]||(u[3]=n=>a.value.requiredWhenFiltering=n)},{default:l(()=>[y(" 筛选资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(V,{span:8},{default:l(()=>[e(g,{prop:"userGroupTaggable"},{default:l(()=>[e(F,{modelValue:a.value.userGroupTaggable,"onUpdate:modelValue":u[4]||(u[4]=n=>a.value.userGroupTaggable=n)},{default:l(()=>[y(" 在用户组中可选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{prop:"description",label:"描述"},{default:l(()=>[e(h,{type:"textarea",modelValue:a.value.description,"onUpdate:modelValue":u[5]||(u[5]=n=>a.value.description=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},oe={style:{"margin-bottom":"10px"}},ge={__name:"ResourceTagEntry",props:{simpleMode:{default:!1,required:!1}},setup(q){const b=q,f=d({}),o=d([]);function a(E){o.value=E}const _=d();function s(){_.value.fetchData()}function C(){Q({tagEntryIds:o.value.map(E=>E.id)}).then(()=>{s()})}return(E,v)=>{const r=m("ElSpace");return N(),I(w,null,[k("div",oe,[b.simpleMode?z("",!0):(N(),G(r,{key:0,alignment:"normal"},{default:l(()=>[e(ae,{onConfirm:s}),e(le,{"selected-entries":o.value},null,8,["selected-entries"]),e(te,{"selected-entries":o.value,onConfirm:s},null,8,["selected-entries"]),e(p(B),{title:"确认删除?",onConfirm:C},{reference:l(()=>[e(x,{disabled:o.value.length===0,type:"danger",plain:""},{default:l(()=>[y(" 删除 ")]),_:1},8,["disabled"])]),_:1})]),_:1})),e(p(K),{style:{float:"right",width:"20%"},modelValue:f.value.search,"onUpdate:modelValue":v[0]||(v[0]=i=>f.value.search=i),"suffix-icon":"search"},null,8,["modelValue"])]),e(S,{ref_key:"tableRef",ref:_,"paging-request":f.value,"remote-method":p(L),onSelectionChange:a},{default:l(()=>[e(p(U),{type:"selection","reserve-selection":""}),e(p(U),{prop:"tagKey",label:"标签键",sortable:"custom"}),e(p(U),{prop:"tagKeyName",label:"标签键名称",sortable:"custom"}),e(p(U),{prop:"description",label:"描述"}),e(p(U),{prop:"createdAt",label:"创建时间",sortable:"custom"})]),_:1},8,["paging-request","remote-method"])],64)}}};export{ge as default};
