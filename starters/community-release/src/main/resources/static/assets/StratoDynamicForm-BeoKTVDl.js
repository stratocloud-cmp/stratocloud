import{ac as w,a8 as g,r as b,m as S,o as s,q as m,w as d,d as p,t as V,u as F,y as M,b as C,F as N,e as c,v as y,aa as B,G as H,H as A,ab as O,n as f,i as T,af as x,b7 as j,B as R,I as L}from"./index-C_jnbPMf.js";import{g as z,k as J,_ as P,d as G}from"./IpState-yQwbBpiP.js";import{_ as W}from"./UserSelector-Bks_jgjv.js";import{_}from"./StratoPagingSelector-BY9rDrJk.js";import{d as Y}from"./role-DAS94606.js";import{a as K}from"./job-B1agJq36.js";import{d as Q}from"./scriptDefinition-BwQHe3UI.js";const X={style:{float:"left"}},Z={style:{float:"right",color:"grey"}},ee={__name:"RoleSelector",props:w({placeholder:{required:!1},multiple:{required:!1,default:!1,type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,i=b({roleIds:t.multiple?l.value:l.value?[l.value]:void 0});return S(()=>l.value,()=>{i.value.roleIds=t.multiple?l.value:l.value?[l.value]:void 0}),(r,a)=>(s(),m(_,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=o=>l.value=o),"paging-request":i.value,"label-getter":o=>o.name,placeholder:e.placeholder,"remote-method":F(Y),multiple:e.multiple},{default:d(o=>[p("span",X,V(o.row.name),1),p("span",Z,V(o.row.type),1)]),_:1},8,["modelValue","paging-request","label-getter","placeholder","remote-method","multiple"]))}},le={style:{float:"left"}},te={style:{float:"right",color:"grey"}},oe={__name:"JobDefinitionSelector",props:w({placeholder:{required:!1},multiple:{required:!1,default:!1,type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,i=b({jobTypes:t.multiple?l.value:l.value?[l.value]:void 0});return S(()=>l.value,()=>{i.value.jobTypes=t.multiple?l.value:l.value?[l.value]:void 0}),(r,a)=>(s(),m(_,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=o=>l.value=o),"paging-request":i.value,"label-getter":o=>o.jobTypeName,"value-getter":o=>o.jobType,placeholder:e.placeholder,"remote-method":F(K),multiple:e.multiple},{default:d(o=>[p("span",le,V(o.row.jobTypeName),1),p("span",te,V(o.row.jobType),1)]),_:1},8,["modelValue","paging-request","label-getter","value-getter","placeholder","remote-method","multiple"]))}},ne={__name:"ScriptDefinitionSelector",emits:["change"],setup(e,{emit:l}){const t=b(),i=l;function r(a){i("change",a)}return(a,o)=>(s(),m(_,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value=n),"label-getter":n=>n.name,"remote-method":F(Q),onChange:r},null,8,["modelValue","label-getter","remote-method"]))}},ae={style:{width:"100%"}},ie={__name:"ScriptDefinitionWrappedSelector",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=b();function i(r){r&&r.remoteScriptDef&&(t.value=r.remoteScriptDef.customFormMetaData)}return M(()=>{console.log(l.value)}),(r,a)=>(s(),C("div",ae,[l.value?(s(),C(N,{key:0},[c(ne,{onChange:i,modelValue:l.value.scriptDefinitionId,"onUpdate:modelValue":a[0]||(a[0]=o=>l.value.scriptDefinitionId=o)},null,8,["modelValue"]),t.value&&l.value.customFormData?(s(),m(we,{key:0,style:{"margin-top":"12px"},"form-meta-data":t.value,modelValue:l.value.customFormData,"onUpdate:modelValue":a[1]||(a[1]=o=>l.value.customFormData=o)},null,8,["form-meta-data","modelValue"])):y("",!0)],64)):y("",!0)]))}};function de(e){switch(e){case"USER":return W;case"ROLE":return ee;case"JOB_DEFINITION":return oe;case"SCRIPT_DEFINITION":return ie}return H({setup(){return()=>A("div",{},"Unknown entity type:"+e)}})}class U{constructor(l){this.formDataRef=l,this.args={}}isConditionsMatched(l){if(!l||l.length===0)return!0;for(let t of l)if(!{...this.formDataRef.value,isMatched:new Function("args","return "+t)}.isMatched(this.args))return!1;return!0}setArg(l,t){this.args[l]=t}setArgs(l){if(l)for(let t in l)this.setArg(t,l[t])}}function ue(e){const l=new U(e);return B("dynamicFormContext",l),l}function q(){return O("dynamicFormContext",new U({}))}const re=["innerHTML"],se={__name:"DynamicFormInput",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{defaultValue:void 0,required:void 0,conditions:[],regex:void 0,regexMessage:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,i=b([]);M(()=>{var o,n,u;(o=t.fieldInfo.detail)!=null&&o.defaultValue&&!l.value&&(l.value=t.fieldInfo.detail.defaultValue),(n=t.fieldInfo.detail)!=null&&n.required&&i.value.push({required:!0,message:"请输入"+t.fieldInfo.label}),(u=t.fieldInfo.detail)!=null&&u.regex&&i.value.push({validator:z(t.fieldInfo.detail.regex,t.fieldInfo.detail.regexMessage),trigger:["blur","change"]})});const r=q();function a(){return r.isConditionsMatched(t.fieldInfo.detail.conditions)}return(o,n)=>{const u=f("ElIcon"),h=f("ElTooltip"),v=f("ElInput"),I=f("ElFormItem");return a()?(s(),m(I,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:i.value},{label:d(()=>[p("span",null,[T(V(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(h,{key:0},{content:d(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,re)]),default:d(()=>[c(u,{style:{cursor:"pointer"}},{default:d(()=>[c(F(x))]),_:1})]),_:1})):y("",!0)])]),default:d(()=>{var k,D,E;return[c(v,{type:(k=e.fieldInfo.detail)==null?void 0:k.inputType,"show-password":((D=e.fieldInfo.detail)==null?void 0:D.inputType)==="password",autocomplete:((E=e.fieldInfo.detail)==null?void 0:E.inputType)==="password"?"new-password":"off",modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=$=>l.value=$)},null,8,["type","show-password","autocomplete","modelValue"])]}),_:1},8,["prop","label","rules"])):y("",!0)}}},fe=["innerHTML"],me={key:2},ce={__name:"DynamicFormSelect",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{multiSelect:!1,defaultValues:[],options:[],optionNames:[],source:void 0,entityType:void 0,dependsOn:[],required:!0,conditions:[],type:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,i=b([]),r=j();S(t,()=>{var n,u;(n=t.fieldInfo.detail)!=null&&n.defaultValues&&t.fieldInfo.detail.defaultValues.length>0&&!l.value&&(t.fieldInfo.detail.multiSelect?l.value=t.fieldInfo.detail.defaultValues:l.value=t.fieldInfo.detail.defaultValues[0]),(u=t.fieldInfo.detail)!=null&&u.required&&i.value.push({required:!0,message:"请选择"+t.fieldInfo.label}),t.fieldInfo.detail.source==="ENTITY"&&(r.value=de(t.fieldInfo.detail.entityType))},{immediate:!0});const a=q();function o(){return a.isConditionsMatched(t.fieldInfo.detail.conditions)}return(n,u)=>{const h=f("ElIcon"),v=f("ElTooltip"),I=f("ElOption"),k=f("ElSelect"),D=f("ElFormItem");return o()?(s(),m(D,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:i.value},{label:d(()=>[p("span",null,[T(V(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(v,{key:0},{content:d(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,fe)]),default:d(()=>[c(h,{style:{cursor:"pointer"}},{default:d(()=>[c(F(x))]),_:1})]),_:1})):y("",!0)])]),default:d(()=>[e.fieldInfo.detail.source==="STATIC"?(s(),m(k,{key:0,modelValue:l.value,"onUpdate:modelValue":u[0]||(u[0]=E=>l.value=E),filterable:"",multiple:e.fieldInfo.detail.multiSelect,"allow-create":e.fieldInfo.detail.allowCreate,placeholder:"请选择"+e.fieldInfo.label},{default:d(()=>[(s(!0),C(N,null,R(e.fieldInfo.detail.options,(E,$)=>(s(),m(I,{key:E,value:E,label:e.fieldInfo.detail.optionNames[$]},null,8,["value","label"]))),128))]),_:1},8,["modelValue","multiple","allow-create","placeholder"])):r.value?(s(),m(L(r.value),{key:1,modelValue:l.value,"onUpdate:modelValue":u[1]||(u[1]=E=>l.value=E),multiple:e.fieldInfo.detail.multiSelect,placeholder:"请选择"+e.fieldInfo.label},null,8,["modelValue","multiple","placeholder"])):(s(),C("div",me,"Unknown options source: "+V(e.fieldInfo.detail.source),1))]),_:1},8,["prop","label","rules"])):y("",!0)}}},pe=["innerHTML"],Ie={__name:"DynamicFormNumber",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{defaultValue:void 0,required:void 0,conditions:[],min:void 0,max:void 0,placeholder:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,i=b([]);M(()=>{var o,n;(o=t.fieldInfo.detail)!=null&&o.defaultValue&&!l.value&&(l.value=t.fieldInfo.detail.defaultValue),(n=t.fieldInfo.detail)!=null&&n.required&&i.value.push({required:!0,message:"请输入"+t.fieldInfo.label})});const r=q();function a(){return r.isConditionsMatched(t.fieldInfo.detail.conditions)}return(o,n)=>{const u=f("ElIcon"),h=f("ElTooltip"),v=f("ElInputNumber"),I=f("ElFormItem");return a()?(s(),m(I,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:i.value},{label:d(()=>[p("span",null,[T(V(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(h,{key:0},{content:d(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,pe)]),default:d(()=>[c(u,{style:{cursor:"pointer"}},{default:d(()=>[c(F(x))]),_:1})]),_:1})):y("",!0)])]),default:d(()=>[c(v,{style:{width:"100%"},modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=k=>l.value=k),min:e.fieldInfo.detail.min,max:e.fieldInfo.detail.max,placeholder:e.fieldInfo.detail.placeholder},null,8,["modelValue","min","max","placeholder"])]),_:1},8,["prop","label","rules"])):y("",!0)}}},ye=["innerHTML"],ve={__name:"DynamicFormBoolean",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{defaultValue:void 0,conditions:[]}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e;M(()=>{var a;((a=t.fieldInfo.detail)==null?void 0:a.defaultValue)!==void 0&&l.value===void 0&&(l.value=t.fieldInfo.detail.defaultValue)});const i=q();function r(){return i.isConditionsMatched(t.fieldInfo.detail.conditions)}return(a,o)=>{const n=f("ElIcon"),u=f("ElTooltip"),h=f("ElSwitch"),v=f("ElFormItem");return r()?(s(),m(v,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label},{label:d(()=>[p("span",null,[T(V(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(u,{key:0},{content:d(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,ye)]),default:d(()=>[c(n,{style:{cursor:"pointer"}},{default:d(()=>[c(F(x))]),_:1})]),_:1})):y("",!0)])]),default:d(()=>[c(h,{style:{width:"100%"},modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=I=>l.value=I)},null,8,["modelValue"])]),_:1},8,["prop","label"])):y("",!0)}}},Ve={style:{float:"left"}},he={style:{float:"right",color:"grey"}},ge={__name:"IpSelector",props:w({placeholder:{required:!1},protocol:{required:!1},multipleLimit:{required:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),i=b({protocol:e.protocol}),r=J();return S(r.networkResourceId,()=>{i.value.networkResourceId=r.networkResourceId.value}),(a,o)=>(s(),m(_,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=n=>l.value=n),"paging-request":i.value,"label-getter":n=>n.address,"value-getter":n=>n.address,"disabled-option-flag-getter":n=>n.state!=="AVAILABLE",placeholder:e.placeholder,"remote-method":F(G),multiple:"","multiple-limit":e.multipleLimit,"allow-create":"","sorted-by":"toBigInteger",direction:"ASC"},{default:d(n=>[p("span",Ve,V(n.row.address),1),p("span",he,[c(P,{state:n.row.state},null,8,["state"])])]),_:1},8,["modelValue","paging-request","label-getter","value-getter","disabled-option-flag-getter","placeholder","remote-method","multiple-limit"]))}},be=["innerHTML"],Ee={__name:"DynamicFormIp",props:w({fieldInfo:{required:!0,default:{type:void 0,key:void 0,label:void 0,description:void 0,detail:{multipleLimit:void 0,protocol:void 0,required:void 0,conditions:[],placeholder:void 0}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=g(e,"modelValue"),t=e,i=b([]);M(()=>{var o;(o=t.fieldInfo.detail)!=null&&o.required&&i.value.push({required:!0,message:"请选择"+t.fieldInfo.label})});const r=q();function a(){return r.isConditionsMatched(t.fieldInfo.detail.conditions)}return(o,n)=>{const u=f("ElIcon"),h=f("ElTooltip"),v=f("ElFormItem");return a()?(s(),m(v,{key:0,prop:e.fieldInfo.key,label:e.fieldInfo.label,rules:i.value},{label:d(()=>[p("span",null,[T(V(e.fieldInfo.label)+" ",1),e.fieldInfo.description?(s(),m(h,{key:0},{content:d(()=>[p("div",{style:{"white-space":"pre-wrap"},innerHTML:e.fieldInfo.description},null,8,be)]),default:d(()=>[c(u,{style:{cursor:"pointer"}},{default:d(()=>[c(F(x))]),_:1})]),_:1})):y("",!0)])]),default:d(()=>[c(ge,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=I=>l.value=I),"multiple-limit":e.fieldInfo.detail.multipleLimit,protocol:e.fieldInfo.detail.protocol,placeholder:e.fieldInfo.detail.placeholder},null,8,["modelValue","multiple-limit","protocol","placeholder"])]),_:1},8,["prop","label","rules"])):y("",!0)}}},we={__name:"StratoDynamicForm",props:w({formMetaData:{required:!0,default:{formClass:void 0,fieldInfoList:[]}},size:{required:!1,default:"default",options:["small","default","large",""]},args:{required:!1,default:{}}},{modelValue:{required:!0,default:{}},modelModifiers:{}}),emits:["update:modelValue"],setup(e,{expose:l}){const t=e,i=b();l({validate:r});function r(u){i.value.validate(u)}const a=g(e,"modelValue");function o(u){switch(u){case"InputField":return se;case"SelectField":return ce;case"NumberField":return Ie;case"BooleanField":return ve;case"IpField":return Ee}}ue(a).setArgs(t.args);for(let u of t.formMetaData.fieldInfoList)u.type==="SelectField"&&u.detail&&u.detail.entityType==="SCRIPT_DEFINITION"&&(a.value[u.key]||(a.value[u.key]={customFormData:{}}));return(u,h)=>{const v=f("ElForm");return s(),m(v,{size:e.size,ref_key:"formRef",ref:i,model:a.value,"label-position":"top","hide-required-asterisk":""},{default:d(()=>[(s(!0),C(N,null,R(e.formMetaData.fieldInfoList,I=>(s(),m(L(o(I.type)),{modelValue:a.value[I.key],"onUpdate:modelValue":k=>a.value[I.key]=k,"field-info":I},null,8,["modelValue","onUpdate:modelValue","field-info"]))),256))]),_:1},8,["size","model"])}}};export{we as _};
