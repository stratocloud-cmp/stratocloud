import{S as U}from"./StratoButton-D7m4JR2l.js";import{_ as P}from"./StratoTable--zpPaOW_.js";import{d as F,a as $,b as A,c as B,e as T}from"./UpdateUserGroupForm-DiKiLtPX.js";import{_ as C}from"./StratoDrawer-BQ9z9CYD.js";import{c as I}from"./job-B1agJq36.js";import{u as w}from"./activeJob-H4xjMLbI.js";import{l as J}from"./request-BV6gXtmx.js";import{r as a,o as v,b as S,e,w as r,i as D,q as k,v as E,F as h,n as O,d as j,u as y,O as q,f as z,P as G}from"./index-C_jnbPMf.js";import{_ as M}from"./User-BHGOje1f.js";import"./TenantTreeSelector-DrVO4R-0.js";import"./TagValueSelectorGroup-kSkYehu4.js";import"./tag-CWCUpvbv.js";import"./StratoPagingSelector-BY9rDrJk.js";import"./UserSelector-Bks_jgjv.js";import"./user-BKxh-AQB.js";import"./UpdateUserForm-BMOXtGcr.js";import"./role-DAS94606.js";const N={__name:"CreateUserGroupButton",emits:["confirm"],setup(_,{emit:c}){const f=w(),t=a(!1),o=a(!1);function u(){n.value=J.cloneDeep(i),t.value=!0}const i={tenantId:void 0,name:void 0,alias:void 0,description:void 0,tags:[]},n=a(J.cloneDeep(i)),p=a(),b=c;function d(){p.value.validate(s=>{s&&(o.value=!0,I({jobType:"CREATE_USER_GROUP",jobParameters:n.value}).then(l=>{t.value=!1,f.setActiveJobId(l.jobId),b("confirm")}).finally(()=>{o.value=!1}))})}return(s,l)=>(v(),S(h,null,[e(U,{type:"primary",onClick:u},{default:r(()=>[D("创建")]),_:1}),e(C,{modelValue:t.value,"onUpdate:modelValue":l[1]||(l[1]=m=>t.value=m),title:"创建用户组",onOnConfirm:d,loading:o.value,size:"600"},{default:r(()=>[t.value?(v(),k(F,{key:0,ref_key:"formRef",ref:p,modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=m=>n.value=m)},null,8,["modelValue"])):E("",!0)]),_:1},8,["modelValue","loading"])],64))}},L={__name:"UpdateUserGroupButton",props:{selectedGroups:{type:Array,required:!0}},emits:["confirm"],setup(_,{emit:c}){const f=w(),t=_,o=a(!1),u=a(!1);function i(){t.selectedGroups.length!==0&&(n.value.userGroupId=t.selectedGroups[0].id,o.value=!0)}const n=a({}),p=a(),b=c;function d(){p.value.validate(s=>{s&&(u.value=!0,I({jobType:"UPDATE_USER_GROUP",jobParameters:n.value}).then(l=>{o.value=!1,f.setActiveJobId(l.jobId),b("confirm")}).finally(()=>{u.value=!1}))})}return(s,l)=>(v(),S(h,null,[e(U,{disabled:_.selectedGroups.length!==1,"disabled-message":"请选择并只选择一项",onClick:i},{default:r(()=>[D("更新")]),_:1},8,["disabled"]),e(C,{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=m=>o.value=m),title:"更新用户组",onOnConfirm:d,loading:u.value,size:"600"},{default:r(()=>[o.value?(v(),k($,{key:0,ref_key:"formRef",ref:p,modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=m=>n.value=m)},null,8,["modelValue"])):E("",!0)]),_:1},8,["modelValue","loading"])],64))}},H={__name:"JoinUserGroupButton",emits:["confirm"],setup(_,{emit:c}){const f=w(),t=a(!1),o=a(!1);function u(){t.value=!0}const i=a({}),n=a(),p=c;function b(){n.value.validate(d=>{d&&(o.value=!0,I({jobType:"JOIN_USER_GROUP",jobParameters:i.value}).then(s=>{t.value=!1,f.setActiveJobId(s.jobId),p("confirm")}).finally(()=>{o.value=!1}))})}return(d,s)=>{const l=O("ElButton");return v(),S(h,null,[e(l,{onClick:u,type:"primary",link:""},{default:r(()=>[D("找不到期望的用户组? 点击此处申请加入")]),_:1}),e(C,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=m=>t.value=m),title:"申请加入用户组",onOnConfirm:b,loading:o.value},{default:r(()=>[e(A,{ref_key:"formRef",ref:n,modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=m=>i.value=m)},null,8,["modelValue"])]),_:1},8,["modelValue","loading"])],64)}}},K=j("span",{style:{"font-size":"12px"}},"邀请新成员",-1),Q=j("span",{style:{"font-size":"12px"}},"移除成员",-1),W={__name:"MembersButton",props:{selectedGroups:{type:Array,required:!0}},setup(_){const c=w(),f=_,t=a(!1),o=a(),u=a();function i(){f.selectedGroups.length!==0&&(o.value=f.selectedGroups[0],t.value=!0)}const n=a([]);function p(g){n.value=g}function b(){I({jobType:"REMOVE_USERS_FROM_GROUP",jobParameters:{userGroupId:o.value.id,userIds:n.value.map(g=>g.id)}}).then(g=>{c.setActiveJobId(g.jobId),u.value.fetchData()})}const d=a({userGroupId:void 0,userIds:[]}),s=a(),l=a(!1);function m(){d.value.userGroupId=o.value.id,l.value=!0}function x(){s.value.validate(g=>{g&&I({jobType:"INVITE_USERS_TO_GROUP",jobParameters:d.value}).then(V=>{l.value=!1,c.setActiveJobId(V.jobId),u.value.fetchData()})})}return(g,V)=>(v(),S(h,null,[e(U,{disabled:_.selectedGroups.length!==1,"disabled-message":"请选择并只选择一项",onClick:i},{default:r(()=>[D("成员管理")]),_:1},8,["disabled"]),e(C,{size:800,modelValue:t.value,"onUpdate:modelValue":V[0]||(V[0]=R=>t.value=R),title:"成员管理","no-confirm":""},{default:r(()=>[t.value?(v(),k(M,{key:0,"simple-mode":"","user-group-ids":[o.value.id],onChange:p,ref_key:"tableRef",ref:u},{buttons:r(()=>[e(U,{size:"small",type:"success",plain:"",onClick:m},{default:r(()=>[K]),_:1}),e(U,{size:"small",type:"danger",plain:"",disabled:n.value.length===0,onClick:b},{default:r(()=>[Q]),_:1},8,["disabled"])]),_:1},8,["user-group-ids"])):E("",!0)]),_:1},8,["modelValue"]),e(C,{modelValue:l.value,"onUpdate:modelValue":V[2]||(V[2]=R=>l.value=R),title:"邀请新成员",onOnConfirm:x},{default:r(()=>[e(B,{ref_key:"inviteFormRef",ref:s,modelValue:d.value,"onUpdate:modelValue":V[1]||(V[1]=R=>d.value=R)},null,8,["modelValue"])]),_:1},8,["modelValue"])],64))}},X={style:{"margin-bottom":"10px"}},ve={__name:"UserGroup",props:{simpleMode:{default:!1,required:!1}},setup(_){const c=_,f=a({}),t=a([]);function o(n){t.value=n}const u=a();function i(){u.value.fetchData()}return(n,p)=>{const b=O("ElSpace");return v(),S(h,null,[j("div",X,[c.simpleMode?E("",!0):(v(),k(b,{key:0,alignment:"normal"},{default:r(()=>[e(N,{onConfirm:i}),e(L,{"selected-groups":t.value,onConfirm:i},null,8,["selected-groups"]),e(W,{"selected-groups":t.value},null,8,["selected-groups"]),e(y(q),{title:"确认删除"},{reference:r(()=>[e(U,{disabled:t.value.length===0,type:"danger",plain:""},{default:r(()=>[D("删除")]),_:1},8,["disabled"])]),_:1}),e(H)]),_:1})),e(y(z),{style:{float:"right",width:"20%"},modelValue:f.value.search,"onUpdate:modelValue":p[0]||(p[0]=d=>f.value.search=d),"suffix-icon":"search"},null,8,["modelValue"])]),e(P,{ref_key:"tableRef",ref:u,"paging-request":f.value,"remote-method":y(T),onSelectionChange:o},{default:r(()=>[c.simpleMode?E("",!0):(v(),k(y(G),{key:0,type:"selection","reserve-selection":""})),e(y(G),{prop:"name",label:"名称",sortable:"custom"}),e(y(G),{prop:"alias",label:"别名",sortable:"custom"}),e(y(G),{prop:"description",label:"描述"}),e(y(G),{prop:"createdAt",label:"创建时间",sortable:"custom"})]),_:1},8,["paging-request","remote-method"])],64)}}};export{ve as default};
