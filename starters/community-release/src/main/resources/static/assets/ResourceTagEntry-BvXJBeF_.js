import{_ as G}from"./StratoTable-BQdButlV.js";import{d as j,a as H,r as J,c as L,u as Q,b as X,e as Y}from"./tag-By1EEBOS.js";import{S as K}from"./StratoButton-AnmxT3yq.js";import{_ as w}from"./StratoDrawer-BEn6vZyQ.js";import{r as s,n as m,o as q,b as W,e,w as l,i as y,q as k,d as I,u as p,O as z,v as A,f as T,a6 as $,F as R,t as Z,P as N}from"./index-C6PxR8iA.js";import{_ as O}from"./CategorySelector-BC9lVLZm.js";import"./request-BGZJNm7h.js";import"./StratoSelector-BPbvdP-M.js";import"./resource-Bh2jHR95.js";const ee={style:{"margin-bottom":"10px",height:"32px"}},le=I("span",{style:{"font-size":"12px"}},"新建标签值",-1),ae=I("span",{style:{"font-size":"12px"}},"删除标签值",-1),te={__name:"TagValuesButton",props:{selectedEntries:{type:Array,required:!0}},setup(F){const E=F,f=s(),o=s(),t=s(!1);function _(){E.selectedEntries.length!==0&&(o.value=E.selectedEntries[0],i.value.tagEntryKey=E.selectedEntries[0].tagKey,t.value=!0)}const i=s({}),C=s([]);function b(V){C.value=V}const v=s(!1),u=s(),n=s({}),r=s({tagValue:[{required:!0,message:"请输入标签值"}],tagValueName:[{required:!0,message:"请输入标签值名称"}],index:[{required:!0,message:"请输入序号"}]});function h(){n.value.tagEntryId=o.value.id,v.value=!0}function g(){u.value.validate(V=>{V&&H(n.value).then(()=>{f.value.fetchData(),v.value=!1})})}function x(){J({tagEntryId:o.value.id,tagValueIds:C.value.map(V=>V.id)}).then(()=>{f.value.fetchData()})}return(V,a)=>{var S;const D=m("ElButton"),B=m("ElSpace"),d=m("ElTableColumn"),U=m("ElFormItem"),M=m("ElInputNumber"),P=m("ElForm");return q(),W(R,null,[e(D,{type:"primary",link:"",onClick:_},{default:l(()=>[y("管理标签值")]),_:1}),(q(),k($,{to:"body"},[e(w,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=c=>t.value=c),title:(S=o.value)==null?void 0:S.tagKeyName,"no-confirm":"",size:800},{default:l(()=>[I("div",ee,[E.simpleMode?A("",!0):(q(),k(B,{key:0,alignment:"normal"},{default:l(()=>[e(K,{type:"success",plain:"",size:"small",onClick:h},{default:l(()=>[le]),_:1}),e(p(z),{title:"确认删除?",onConfirm:x},{reference:l(()=>[e(K,{disabled:C.value.length===0,type:"danger",plain:"",size:"small"},{default:l(()=>[ae]),_:1},8,["disabled"])]),_:1})]),_:1})),e(p(T),{style:{float:"right",width:"20%"},modelValue:i.value.search,"onUpdate:modelValue":a[0]||(a[0]=c=>i.value.search=c),"suffix-icon":"search"},null,8,["modelValue"])]),e(G,{ref_key:"tableRef",ref:f,"paging-request":i.value,"remote-method":p(j),onSelectionChange:b,"sorted-by":"index",direction:"ASC"},{default:l(()=>[e(d,{type:"selection","reserve-selection":""}),e(d,{prop:"tagValue",label:"标签键",sortable:"custom"}),e(d,{prop:"tagValueName",label:"标签键名称",sortable:"custom"}),e(d,{prop:"description",label:"描述"}),e(d,{prop:"createdAt",label:"创建时间",sortable:"custom"})]),_:1},8,["paging-request","remote-method"])]),_:1},8,["modelValue","title"]),e(w,{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=c=>v.value=c),title:"新建标签值",onOnConfirm:g},{default:l(()=>[e(P,{ref_key:"addValueFormRef",ref:u,model:n.value,rules:r.value,"label-position":"top"},{default:l(()=>[e(U,{prop:"tagValue",label:"标签值"},{default:l(()=>[e(p(T),{placeholder:"请输入标签值",modelValue:n.value.tagValue,"onUpdate:modelValue":a[2]||(a[2]=c=>n.value.tagValue=c)},null,8,["modelValue"])]),_:1}),e(U,{prop:"tagValueName",label:"标签值名称"},{default:l(()=>[e(p(T),{placeholder:"请输入标签值名称",modelValue:n.value.tagValueName,"onUpdate:modelValue":a[3]||(a[3]=c=>n.value.tagValueName=c)},null,8,["modelValue"])]),_:1}),e(U,{prop:"index",label:"序号"},{default:l(()=>[e(M,{style:{width:"100%"},min:0,placeholder:"请输入序号",modelValue:n.value.index,"onUpdate:modelValue":a[4]||(a[4]=c=>n.value.index=c)},null,8,["modelValue"])]),_:1}),e(U,{prop:"description",label:"描述"},{default:l(()=>[e(p(T),{type:"textarea",placeholder:"请输入描述",modelValue:n.value.description,"onUpdate:modelValue":a[5]||(a[5]=c=>n.value.description=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]))],64)}}},oe={__name:"CreateEntryButton",emits:["confirm"],setup(F,{emit:E}){const f=s(),o=s({tagKey:void 0,tagKeyName:void 0,resourceCategory:void 0,requiredWhenCreating:!0,requiredWhenFiltering:!0,userGroupTaggable:!1}),t=s(!1);function _(){t.value=!0}const i=s({tagKey:[{required:!0,message:"请输入标签键"}],tagKeyName:[{required:!0,message:"请输入标签键名称"}]}),C=E;function b(){f.value.validate(v=>{v&&L(o.value).then(u=>{t.value=!1,C("confirm")})})}return(v,u)=>{const n=m("ElInput"),r=m("ElFormItem"),h=m("ElCheckbox"),g=m("ElCol"),x=m("ElRow"),V=m("ElForm");return q(),W(R,null,[e(K,{type:"primary",plain:"",onClick:_},{default:l(()=>[y("创建")]),_:1}),e(w,{title:"创建标签键",modelValue:t.value,"onUpdate:modelValue":u[7]||(u[7]=a=>t.value=a),size:"600",onOnConfirm:b},{default:l(()=>[e(V,{ref_key:"formRef",ref:f,model:o.value,rules:i.value,"label-position":"top"},{default:l(()=>[e(r,{prop:"tagKey",label:"标签键"},{default:l(()=>[e(n,{placeholder:"请输入标签键",modelValue:o.value.tagKey,"onUpdate:modelValue":u[0]||(u[0]=a=>o.value.tagKey=a)},null,8,["modelValue"])]),_:1}),e(r,{prop:"tagKeyName",label:"标签键名称"},{default:l(()=>[e(n,{placeholder:"请输入标签键名称",modelValue:o.value.tagKeyName,"onUpdate:modelValue":u[1]||(u[1]=a=>o.value.tagKeyName=a)},null,8,["modelValue"])]),_:1}),e(r,{prop:"resourceCategory",label:"所作用的资源类型"},{default:l(()=>[e(O,{modelValue:o.value.resourceCategory,"onUpdate:modelValue":u[2]||(u[2]=a=>o.value.resourceCategory=a),placeholder:"留空代表作用于所有资源类型"},null,8,["modelValue"])]),_:1}),e(x,null,{default:l(()=>[e(g,{span:8},{default:l(()=>[e(r,{prop:"requiredWhenCreating"},{default:l(()=>[e(h,{modelValue:o.value.requiredWhenCreating,"onUpdate:modelValue":u[3]||(u[3]=a=>o.value.requiredWhenCreating=a)},{default:l(()=>[y(" 创建资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:l(()=>[e(r,{prop:"requiredWhenFiltering"},{default:l(()=>[e(h,{modelValue:o.value.requiredWhenFiltering,"onUpdate:modelValue":u[4]||(u[4]=a=>o.value.requiredWhenFiltering=a)},{default:l(()=>[y(" 筛选资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(g,{span:8},{default:l(()=>[e(r,{prop:"userGroupTaggable"},{default:l(()=>[e(h,{modelValue:o.value.userGroupTaggable,"onUpdate:modelValue":u[5]||(u[5]=a=>o.value.userGroupTaggable=a)},{default:l(()=>[y(" 用户组中可选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{prop:"description",label:"描述"},{default:l(()=>[e(n,{type:"textarea",modelValue:o.value.description,"onUpdate:modelValue":u[6]||(u[6]=a=>o.value.description=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}},re={__name:"UpdateEntryButton",props:{selectedEntries:{required:!0,type:Array}},emits:["confirm"],setup(F,{emit:E}){const f=F,o=s(),t=s({tagEntryId:void 0,tagKeyName:void 0,description:void 0,resourceCategory:void 0,requiredWhenCreating:!0,requiredWhenFiltering:!0,userGroupTaggable:!1}),_=s(!1),i=s();function C(){f.selectedEntries.length!==0&&(i.value=f.selectedEntries[0],t.value.tagEntryId=i.value.id,t.value.tagKeyName=i.value.tagKeyName,t.value.resourceCategory=i.value.resourceCategory,t.value.requiredWhenCreating=i.value.requiredWhenCreating,t.value.requiredWhenFiltering=i.value.requiredWhenFiltering,t.value.userGroupTaggable=i.value.userGroupTaggable,t.value.description=i.value.description,_.value=!0)}const b=s({tagKeyName:[{required:!0,message:"请输入标签键名称"}]}),v=E;function u(){o.value.validate(n=>{n&&Q(t.value).then(r=>{_.value=!1,v("confirm")})})}return(n,r)=>{const h=m("ElButton"),g=m("ElFormItem"),x=m("ElInput"),V=m("ElCheckbox"),a=m("ElCol"),D=m("ElRow"),B=m("ElForm");return q(),W(R,null,[e(h,{link:"",type:"primary",onClick:C},{default:l(()=>[y(" 更新 ")]),_:1}),(q(),k($,{to:"body"},[e(w,{title:"更新标签键",modelValue:_.value,"onUpdate:modelValue":r[6]||(r[6]=d=>_.value=d),size:"600",onOnConfirm:u},{default:l(()=>[e(B,{ref_key:"formRef",ref:o,model:t.value,rules:b.value,"label-position":"top"},{default:l(()=>[e(g,{prop:"tagKey",label:"标签键"},{default:l(()=>{var d;return[y(Z((d=i.value)==null?void 0:d.tagKey),1)]}),_:1}),e(g,{prop:"tagKeyName",label:"标签键名称"},{default:l(()=>[e(x,{placeholder:"请输入标签键名称",modelValue:t.value.tagKeyName,"onUpdate:modelValue":r[0]||(r[0]=d=>t.value.tagKeyName=d)},null,8,["modelValue"])]),_:1}),e(g,{prop:"resourceCategory",label:"所作用的资源类型"},{default:l(()=>[e(O,{modelValue:t.value.resourceCategory,"onUpdate:modelValue":r[1]||(r[1]=d=>t.value.resourceCategory=d),placeholder:"留空代表作用于所有资源类型"},null,8,["modelValue"])]),_:1}),e(D,null,{default:l(()=>[e(a,{span:8},{default:l(()=>[e(g,{prop:"requiredWhenCreating"},{default:l(()=>[e(V,{modelValue:t.value.requiredWhenCreating,"onUpdate:modelValue":r[2]||(r[2]=d=>t.value.requiredWhenCreating=d)},{default:l(()=>[y(" 创建资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(a,{span:8},{default:l(()=>[e(g,{prop:"requiredWhenFiltering"},{default:l(()=>[e(V,{modelValue:t.value.requiredWhenFiltering,"onUpdate:modelValue":r[3]||(r[3]=d=>t.value.requiredWhenFiltering=d)},{default:l(()=>[y(" 筛选资源时必选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(a,{span:8},{default:l(()=>[e(g,{prop:"userGroupTaggable"},{default:l(()=>[e(V,{modelValue:t.value.userGroupTaggable,"onUpdate:modelValue":r[4]||(r[4]=d=>t.value.userGroupTaggable=d)},{default:l(()=>[y(" 在用户组中可选 ")]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(g,{prop:"description",label:"描述"},{default:l(()=>[e(x,{type:"textarea",modelValue:t.value.description,"onUpdate:modelValue":r[5]||(r[5]=d=>t.value.description=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])]))],64)}}},ue={style:{"margin-bottom":"10px"}},ve={__name:"ResourceTagEntry",props:{simpleMode:{default:!1,required:!1}},setup(F){const E=F,f=s({}),o=s([]);function t(b){o.value=b}const _=s();function i(){_.value.fetchData()}function C(){Y({tagEntryIds:o.value.map(b=>b.id)}).then(()=>{i()})}return(b,v)=>{const u=m("ElSpace");return q(),W(R,null,[I("div",ue,[E.simpleMode?A("",!0):(q(),k(u,{key:0,alignment:"normal"},{default:l(()=>[e(oe,{onConfirm:i}),e(p(z),{title:"确认删除?",onConfirm:C},{reference:l(()=>[e(K,{disabled:o.value.length===0,type:"danger",plain:""},{default:l(()=>[y(" 删除 ")]),_:1},8,["disabled"])]),_:1})]),_:1})),e(p(T),{style:{float:"right",width:"20%"},modelValue:f.value.search,"onUpdate:modelValue":v[0]||(v[0]=n=>f.value.search=n),"suffix-icon":"search"},null,8,["modelValue"])]),e(G,{ref_key:"tableRef",ref:_,"paging-request":f.value,"remote-method":p(X),onSelectionChange:t},{default:l(()=>[e(p(N),{type:"selection","reserve-selection":""}),e(p(N),{prop:"tagKey",label:"标签键",sortable:"custom"}),e(p(N),{prop:"tagKeyName",label:"标签键名称",sortable:"custom"}),e(p(N),{prop:"description",label:"描述"}),e(p(N),{prop:"createdAt",label:"创建时间",sortable:"custom"}),e(p(N),{"min-width":"60"},{default:l(n=>[e(te,{"selected-entries":[n.row]},null,8,["selected-entries"]),e(re,{"selected-entries":[n.row],onConfirm:i},null,8,["selected-entries"])]),_:1})]),_:1},8,["paging-request","remote-method"])],64)}}};export{ve as default};
