import{_ as I}from"./StratoTable-CDLvuijz.js";import{u as k,e as F,f as J,g as U,t as q}from"./job-D_aeKnDK.js";import{_ as B}from"./StratoDrawer-SANI4yOp.js";import{r as i,b as D,d as N,e,u as l,w as r,F as O,o as R,f as b,P as s,i as h,x as j,n as m}from"./index-CGSAaZ7c.js";import"./request-BLvKnTIl.js";import"./StratoButton-BbyvpoLv.js";const L={style:{"margin-bottom":"10px",height:"32px"}},K={__name:"JobTrigger",setup(S){const v=i(),c=i({});function u(){v.value.fetchData()}const d=i(!1),n=i({});function x(t){n.value.triggerId=t.triggerId,n.value.cronExpression=t.cronExpression,n.value.description=t.description,d.value=!0}function V(){k(n.value).then(t=>{d.value=!1,u()})}const p=i(!1);function w(t,a){p.value=!0,a?J({triggerId:t}).then(f=>{u()}).finally(()=>{p.value=!1}):U({triggerId:t}).then(f=>{u()}).finally(()=>{p.value=!1})}const g=i(!1);function y(t){g.value=!0,q({triggerId:t.triggerId}).then(a=>{j.success({message:"任务已触发"}),u()}).finally(()=>{g.value=!1})}return(t,a)=>{const f=m("ElSwitch"),_=m("ElButton"),E=m("ElFormItem"),C=m("ElForm");return R(),D(O,null,[N("div",L,[e(l(b),{style:{float:"right",width:"20%"},modelValue:c.value.search,"onUpdate:modelValue":a[0]||(a[0]=o=>c.value.search=o),"suffix-icon":"search"},null,8,["modelValue"])]),e(I,{ref_key:"tableRef",ref:v,"paging-request":c.value,"remote-method":l(F)},{default:r(()=>[e(l(s),{prop:"triggerId",label:"触发器标识",sortable:"custom"}),e(l(s),{prop:"jobType",label:"任务类型标识",sortable:"custom"}),e(l(s),{prop:"jobTypeName",label:"任务类型名称",sortable:"custom"}),e(l(s),{prop:"cronExpression",label:"Cron表达式",sortable:"custom"}),e(l(s),{prop:"nextTriggerTime",label:"下次执行时间",sortable:"custom"}),e(l(s),{prop:"disabled",label:"是否启用",sortable:"custom"},{default:r(o=>[e(f,{loading:p.value,"model-value":!o.row.disabled,onChange:T=>w(o.row.triggerId,T)},null,8,["loading","model-value","onChange"])]),_:1}),e(l(s),{prop:"description",label:"描述",sortable:"custom"}),e(l(s),{width:"60"},{default:r(o=>[e(_,{link:"",type:"primary",onClick:()=>x(o.row)},{default:r(()=>[h("编辑")]),_:2},1032,["onClick"])]),_:1}),e(l(s),{width:"120"},{default:r(o=>[e(_,{loading:g.value,link:"",type:"primary",onClick:()=>y(o.row)},{default:r(()=>[h(" 触发一次 ")]),_:2},1032,["loading","onClick"])]),_:1})]),_:1},8,["paging-request","remote-method"]),e(B,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=o=>d.value=o),title:"编辑触发器",onOnConfirm:V},{default:r(()=>[e(C,{model:n.value,"label-position":"top"},{default:r(()=>[e(E,{prop:"cronExpression",label:"Cron表达式",required:""},{default:r(()=>[e(l(b),{modelValue:n.value.cronExpression,"onUpdate:modelValue":a[1]||(a[1]=o=>n.value.cronExpression=o)},null,8,["modelValue"])]),_:1}),e(E,{prop:"description",label:"描述",required:""},{default:r(()=>[e(l(b),{type:"textarea",modelValue:n.value.description,"onUpdate:modelValue":a[2]||(a[2]=o=>n.value.description=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}};export{K as default};
