import{l as p}from"./request-BV6gXtmx.js";import{ac as b,r as i,a8 as M,y as R,m as y,n as z,o as g,q as S,Q as k,w as s,aj as B,e as D,u as O,bb as A,b as x,F as L,B as U}from"./index-C_jnbPMf.js";const I={__name:"StratoPagingSelector",props:b({remoteMethod:{required:!0},pagingRequest:{default:{},required:!1},defaultPageSize:{default:5,required:!1},labelGetter:{required:!0,type:Function},valueGetter:{required:!1,type:Function,default:u=>u.id},searchAttribute:{required:!1,default:"search"},disabled:{required:!1,default:!1},sortedBy:{required:!1,default:void 0},direction:{required:!1,default:void 0},disabledOptionFlagGetter:{required:!1,type:Function,default:()=>!1},placeholder:{required:!1},multiple:{required:!1,default:!1,type:Boolean},multipleLimit:{required:!1,default:void 0,type:Number},allowCreate:{required:!1,default:!1,type:Boolean},teleported:{required:!1,default:!1,type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:b(["change"],["update:modelValue"]),setup(u,{emit:F}){const n=i(!1),o=M(u,"modelValue"),e=u;function P(){if(!e.multiple)return e.defaultPageSize;if(o.value instanceof Array){const t=o.value.length;return t<=e.defaultPageSize?e.defaultPageSize:t<=5?5:t<=10?10:t<=20?20:t<=50?50:100}return e.defaultPageSize}const l=i({current:1,size:P(),total:0,sortedBy:e.sortedBy,direction:e.direction}),f=i([]),v=i({});function w(){const t={current:l.value.current-1,size:l.value.size,sortedBy:l.value.sortedBy,direction:l.value.direction,...e.pagingRequest,...v.value};return e.remoteMethod(t).then(a=>{l.value.total=parseInt(a.totalElements),f.value=a.content,c.value&&q(o.value),n.value=!1}).catch(a=>{console.error(a),n.value=!1}).finally(()=>{c.value=!1})}const d=p.debounce(w,200),c=i(!1);R(()=>{n.value=!0,c.value=!0,d()});const m=i();y(()=>e.pagingRequest,()=>{p.isEqual(m.value,e.pagingRequest)||(m.value=p.cloneDeep(e.pagingRequest),n.value=!0,d())},{deep:!0}),y([()=>l.value.size,()=>l.value.current,()=>l.value.sortedBy,()=>l.value.direction],()=>{n.value=!0,d()});function E(t){v.value[e.searchAttribute]=t,n.value=!0,d()}const h=F;function G(t){for(let a of f.value)if(e.valueGetter(a)===t)return a}function q(t){t?h("change",G(t)):h("change",void 0)}return(t,a)=>{const V=z("ElOption"),C=z("ElSelect");return g(),S(C,{disabled:e.disabled,loading:n.value,modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=r=>o.value=r),filterable:"","filter-method":E,onChange:q,placeholder:u.placeholder,multiple:u.multiple,"multiple-limit":u.multipleLimit,"allow-create":u.allowCreate,teleported:u.teleported,clearable:""},k({footer:s(()=>[D(O(A),{style:{width:"100%",display:"flex","justify-content":"right"},"current-page":l.value.current,"onUpdate:currentPage":a[0]||(a[0]=r=>l.value.current=r),total:l.value.total,"page-size":l.value.size,"onUpdate:pageSize":a[1]||(a[1]=r=>l.value.size=r),onSizeChange:()=>{},"pager-count":11,size:"small",layout:"prev, pager, next, total"},null,8,["current-page","total","page-size"])]),default:s(()=>[(g(!0),x(L,null,U(f.value,r=>(g(),S(V,{key:e.valueGetter(r),label:e.labelGetter(r),value:e.valueGetter(r),disabled:e.disabledOptionFlagGetter(r)},{default:s(()=>[B(t.$slots,"default",{row:r})]),_:2},1032,["label","value","disabled"]))),128))]),_:2},[t.$slots.header?{name:"header",fn:s(()=>[B(t.$slots,"header")]),key:"0"}:void 0]),1032,["disabled","loading","modelValue","placeholder","multiple","multiple-limit","allow-create","teleported"])}}};export{I as _};
