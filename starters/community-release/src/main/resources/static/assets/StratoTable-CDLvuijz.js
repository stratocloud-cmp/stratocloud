import{l as b}from"./request-BLvKnTIl.js";import{r as l,y as w,z as D,m as p,o as h,b as k,Y as E,q as F,w as I,b0 as R,u as m,bf as P,e as _,b1 as M,F as T,X as U}from"./index-CGSAaZ7c.js";const H={__name:"StratoTable",props:{showSelection:{default:!0,required:!1},remoteMethod:{},pagingRequest:{default:{},required:!1},defaultPageSize:{default:10,required:!1},maxHeight:{default:"550",required:!1},size:{default:void 0,required:!1},rowKeyGetter:{required:!1,type:Function,default:o=>o.id},sortedBy:{required:!1,default:void 0},direction:{required:!1,default:void 0}},emits:["selectionChange","filterChange","listChange"],setup(o,{expose:y,emit:z}){const r=l(!1),a=o,e=l({current:1,size:a.defaultPageSize,total:0,sortedBy:a.sortedBy,direction:a.direction}),i=l([]),s=z;y({fetchData:g,getTotal:x});function C(t){s("selectionChange",t)}function S(t){s("filterChange",t)}function q(t){t.order==="descending"?(e.value.sortedBy=t.prop,e.value.direction="DESC"):t.order==="ascending"?(e.value.sortedBy=t.prop,e.value.direction="ASC"):(e.value.sortedBy=a.sortedBy,e.value.direction=a.direction)}function x(){return e.value.total}function c(){const t={current:e.value.current-1,size:e.value.size,sortedBy:e.value.sortedBy,direction:e.value.direction,...a.pagingRequest};return a.remoteMethod(t).then(n=>{e.value.total=parseInt(n.totalElements),i.value=n.content,s("listChange",i.value)}).finally(()=>{r.value=!1})}const f=l();function g(){return c().finally(()=>{var t;(t=f.value)==null||t.clearSelection()})}const u=b.debounce(g,200),v=l();return w(()=>{r.value=!0,u(),v.value=setInterval(c,1e4)}),D(()=>{clearInterval(v.value)}),p(a.pagingRequest,()=>{r.value=!0,u()}),p([()=>e.value.size,()=>e.value.current,()=>e.value.sortedBy,()=>e.value.direction],()=>{r.value=!0,u()}),(t,n)=>{const B=U("loading");return h(),k(T,null,[E((h(),F(m(P),{ref_key:"tableRef",ref:f,data:i.value,size:a.size,onSelectionChange:C,"row-key":o.rowKeyGetter,onFilterChange:S,onSortChange:q,"max-height":a.maxHeight,"show-overflow-tooltip":"","tooltip-options":{placement:"bottom",enterable:!0},style:{"min-height":"100px"}},{default:I(()=>[R(t.$slots,"default")]),_:3},8,["data","size","row-key","max-height"])),[[B,r.value]]),_(m(M),{"page-sizes":[10,20,50,100],style:{width:"100%","margin-top":"10px",display:"flex","justify-content":"right"},"current-page":e.value.current,"onUpdate:currentPage":n[0]||(n[0]=d=>e.value.current=d),total:e.value.total,"page-size":e.value.size,"onUpdate:pageSize":n[1]||(n[1]=d=>e.value.size=d),onSizeChange:()=>{},"pager-count":11,size:a.size,layout:a.size==="small"?"prev, pager, next, total":"prev, pager, next, total, jumper, sizes"},null,8,["current-page","total","page-size","size","layout"])],64)}}};export{H as _};
